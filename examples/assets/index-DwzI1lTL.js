import{u as v,j as I,h as E,q as P,A as L,o as _,R as U,I as H,r as W,w as q,x as X,y as Z,z as G,C as z,D as Q,E as ee,H as te,a as ne,J as V,e as F,K as oe,P as re,Q as O,S as B}from"./index-B-aNsZHc.js";const se=t=>{const{components:o}=t,n=o.get(v),i=document.createElement("bim-table");i.columns=["Model"],i.headersHidden=!0;const r=[];for(const[,s]of n.groups){if(!s)continue;const u={data:{Model:s.name||s.uuid,Actions:s.uuid}};r.push(u)}return i.dataTransform={Actions:s=>{if(typeof s!="string")return s;const u=n.groups.get(s);return u?I`
        <bim-button @click=${l=>{u.visible=!u.visible;const m=l.target;m.icon=u.visible?"mdi:eye":"mdi:eye-off"}} icon="mdi:eye"></bim-button>
        <bim-button @click=${()=>n.disposeGroup(u)} icon="mdi:delete"></bim-button>
      `:s}},i.columns=["Model",{name:"Actions",width:"auto"}],i.data=r,I`
    <div>
      ${r.length===0?I`<bim-label>No models has been loaded yet</bim-label>`:i}
    </div>
  `},ie=(t,o=!0)=>{const n=E.create(se,t);if(o){const{components:i}=t,r=i.get(v),[,s]=n;r.onFragmentsLoaded.add(()=>setTimeout(()=>s())),r.onFragmentsDisposed.add(()=>s())}return n},ae=Object.freeze(Object.defineProperty({__proto__:null,modelsList:ie},Symbol.toStringTag,{value:"Module"})),Y=["Name","ContainedInStructure","ForLayerSet","LayerThickness","HasProperties","HasAssociations","HasAssignments","HasPropertySets","PredefinedType","Quantities","ReferencedSource","Identification",t=>t.includes("Value"),t=>t.startsWith("Material"),t=>t.startsWith("Relating"),t=>{const o=["IsGroupedBy","IsDecomposedBy"];return t.startsWith("Is")&&!o.includes(t)}];async function $(t,o,n,i=Y,r=!1){const s=t.get(L),u=await o.getProperties(n);if(!u)return{data:{Entity:`${n} properties not found...`}};const h=s.relationMaps[o.uuid],a={data:{}};for(const l in u){const m=i.map(e=>typeof e=="string"?l===e:e(l)).includes(!0);if(!(l==="type"||m))continue;const c=u[l];if(c)if(c.type===5){a.children||(a.children=[]);const e=await $(t,o,c.value,i,r);a.children.push(e)}else if(typeof c=="object"&&!Array.isArray(c)){const{value:e,type:d}=c;if(r)d===1||d===2||d===3||(a.data[l]=e);else{const p=typeof e=="number"?Number(e.toFixed(3)):e;a.data[l]=p}}else if(Array.isArray(c))for(const e of c){if(e.type!==5)continue;a.children||(a.children=[]);const d=await $(t,o,e.value,i,r);a.children.push(d)}else if(l==="type"){const e=_[c];a.data.Entity=e}else a.data[l]=c}if(h&&h.get(u.expressID)){const l=h.get(u.expressID);for(const m of i){const c=[];if(typeof m=="string"){const e=s._inverseAttributes.indexOf(m);e!==-1&&c.push(e)}else{const e=s._inverseAttributes.filter(d=>m(d));for(const d of e){const p=s._inverseAttributes.indexOf(d);c.push(p)}}for(const e of c){const d=l.get(e);if(d)for(const p of d){const g=await $(t,o,p,i,r);a.children||(a.children=[]),a.children.push(g)}}}}return a}const ce=t=>{const{components:o,fragmentIdMap:n,attributesToInclude:i,editable:r,tableDefinition:s}=t,u=o.get(v);let h;return typeof i=="function"?h=i(Y):h=i,I`<bim-table ${P(async l=>{if(!l)return;const m=l,c=[],e=[];for(const d in n){const p=u.list.get(d);if(!(p&&p.group))continue;const g=p.group,w=e.find(f=>f.model===g);if(w)for(const f of n[d])w.expressIDs.add(f);else{const f={model:g,expressIDs:new Set(n[d])};e.push(f)}}for(const d of e){const{model:p,expressIDs:g}=d;for(const w of g){const f=await $(o,p,w,h,r);c.push(f)}}m.dataTransform=s,m.data=c,m.columns=[{name:"Entity",width:"minmax(15rem, 1fr)"}]})}></bim-table>`},le=t=>E.create(ce,t),ue=Object.freeze(Object.defineProperty({__proto__:null,entityAttributes:le},Symbol.toStringTag,{value:"Module"}));function de(t){const o=Object.keys(t).pop();return o&&t[o].length>0?t[o][0]:""}function K(t){return t.map(o=>{const n={data:{System:de(o.filter)}};return o.children&&o.children.length>0&&(n.children=K(o.children)),n})}const pe=t=>{const{components:o,classifications:n}=t,i=o.get(U),r=s=>{if(!s)return;const u=s;u.dataTransform={Actions:l=>l};const h=(l,m={})=>{const c=i.list,e=l[0],d=c[e],p=[];if(!e||!d)return p;for(const g in d){const w={...m,[e]:[g]},f=i.find(w);if(Object.keys(f).length>0){const y={filter:w};y.children=h(l.slice(1),w),p.push(y)}}return p},a=[];for(const l in n){const m=n[l],c=h(m),e=K(c);a.push({data:{System:l},children:e})}u.data=a};return I`
  <div>
    ${Object.keys(n).length===0?I`<bim-label label="No classifications to show"></bim-label>`:I`<bim-table ${P(r)} headers-hidden expanded></bim-table>`}
  </div>
  `},fe=(t,o=!0)=>{const n=E.create(pe,t);if(o){const{components:i}=t,r=i.get(v),[,s]=n;r.onFragmentsDisposed.add(()=>s())}return n},me=Object.freeze(Object.defineProperty({__proto__:null,classificationTree:fe},Symbol.toStringTag,{value:"Module"})),he=["OwnerHistory","ObjectPlacement","CompositionType"],j=async(t,o,n)=>{const r={...{groupName:"Attributes",includeClass:!1},...n},{groupName:s,includeClass:u}=r,h=await t.getProperties(o)??{},a={data:{Name:s}};u&&(a.children||(a.children=[]),a.children.push({data:{Name:"Class",Value:_[h.type]}}));for(const l in h){if(he.includes(l))continue;const m=h[l];if(m&&typeof m=="object"&&!Array.isArray(m)){if(m.type===ee)continue;const c={data:{Name:l,Value:m.value}};a.children||(a.children=[]),a.children.push(c)}}return a},ge=async(t,o)=>{const n={data:{Name:"Property Sets"}};for(const i of o){const r=await t.getProperties(i);if(!r)continue;const s={data:{Name:r.Name.value}};if(r.type===H){for(const u of r.HasProperties){const{value:h}=u,a=await t.getProperties(h);if(!a)continue;const l=Object.keys(a).find(c=>c.includes("Value"));if(!(l&&a[l]))continue;const m={data:{Name:a.Name.value,Value:a[l].value}};s.children||(s.children=[]),s.children.push(m)}s.children&&(n.children||(n.children=[]),n.children.push(s))}}return n},be=async(t,o)=>{const n={data:{Name:"Quantity Sets"}};for(const i of o){const r=await t.getProperties(i);if(!r)continue;const s={data:{Name:r.Name.value}};if(r.type===W){for(const u of r.Quantities){const{value:h}=u,a=await t.getProperties(h);if(!a)continue;const l=Object.keys(a).find(c=>c.includes("Value"));if(!(l&&a[l]))continue;const m={data:{Name:a.Name.value,Value:a[l].value}};s.children||(s.children=[]),s.children.push(m)}s.children&&(n.children||(n.children=[]),n.children.push(s))}}return n},ye=async(t,o)=>{const n={data:{Name:"Materials"}};for(const i of o){const r=await t.getProperties(i);if(r.type===q){const s=r.ForLayerSet.value,u=await t.getProperties(s);for(const h of u.MaterialLayers){const{value:a}=h,l=await t.getProperties(a),m=await t.getProperties(l.Material.value),c={data:{Name:"Layer"},children:[{data:{Name:"Thickness",Value:l.LayerThickness.value}},{data:{Name:"Material",Value:m.Name.value}}]};n.children||(n.children=[]),n.children.push(c)}}if(r.type===z)for(const s of r.Materials){const{value:u}=s,a={data:{Name:"Name",Value:(await t.getProperties(u)).Name.value}};n.children||(n.children=[]),n.children.push(a)}if(r.type===G){const u={data:{Name:"Name",Value:(await t.getProperties(i)).Name.value}};n.children||(n.children=[]),n.children.push(u)}}return n},Ie=async(t,o)=>{var i,r;const n={data:{Name:"Classifications"}};for(const s of o){const u=await t.getProperties(s);if(u.type===Q){const{value:h}=u.ReferencedSource,l={data:{Name:(await t.getProperties(h)).Name.value},children:[{data:{Name:"Identification",Value:((i=u.Identification)==null?void 0:i.value)||((r=u.ItemReference)==null?void 0:r.value)}},{data:{Name:"Name",Value:u.Name.value}}]};n.children||(n.children=[]),n.children.push(l)}}return n},we=t=>{const{components:o,fragmentIdMap:n}=t,i=o.get(L),r=o.get(v);return I`<bim-table ${P(async u=>{var m;if(!u)return;const h=[],a=[];for(const c in n){const e=r.list.get(c);if(!(e&&e.group))continue;const d=e.group,p=a.find(g=>g.model===d);if(p)for(const g of n[c])p.expressIDs.add(g);else{const g={model:d,expressIDs:new Set(n[c])};a.push(g)}}for(const c in a){const{model:e,expressIDs:d}=a[c],p=i.relationMaps[e.uuid];if(!p)return;for(const g of d){const w=await e.getProperties(g);if(!w)continue;const f={data:{Name:(m=w.Name)==null?void 0:m.value,Value:""}};h.push(f);const A=await j(e,g,{includeClass:!0});if(f.children||(f.children=[]),f.children.push(A),!p.get(g))continue;const b=i.getEntityRelations(e,g,"IsDefinedBy");if(b){const x=b.filter(async S=>{const N=await e.getProperties(S);return N?N.type===H:!1}),R=await ge(e,x);R.children&&f.children.push(R);const M=b.filter(async S=>{const N=await e.getProperties(S);return N?N.type===W:!1}),D=await be(e,M);D.children&&f.children.push(D)}const C=i.getEntityRelations(e,g,"HasAssociations");if(C){const x=C.filter(async S=>{const N=await e.getProperties(S);return N?N.type===q||N.type===X||N.type===Z||N.type===G||N.type===z:!1}),R=await ye(e,x);R.children&&f.children.push(R);const M=C.filter(async S=>{const N=await e.getProperties(S);return N?N.type===Q:!1}),D=await Ie(e,M);D.children&&f.children.push(D)}const T=i.getEntityRelations(e,g,"ContainedInStructure");if(T){const x=T[0],R=await j(e,x,{groupName:"SpatialContainer"});f.children.push(R)}}}const l=u;l.addEventListener("cellcreated",({detail:c})=>{const e=c.cell.parentNode;if(!e)return;const d=e.querySelector("bim-table-cell[column='Name']"),p=e.querySelector("bim-table-cell[column='Value']");!(p!=null&&p.data)&&d&&(d.style.gridColumn="1 / -1")}),l.columns=[{name:"Name",width:"12rem"}],l.data=h})} headers-hidden></bim-table>`},Ce=t=>E.create(we,t),Ne=Object.freeze(Object.defineProperty({__proto__:null,elementProperties:Ce},Symbol.toStringTag,{value:"Module"})),k=async(t,o,n,i)=>{var l;const r=[],s=t.get(L),u=await o.getProperties(n);if(!u)return r;const{type:h}=u,a={data:{Entity:_[h],Name:(l=u.Name)==null?void 0:l.value}};for(const m of i){const c=s.getEntityRelations(o,n,m);if(c)for(const e of c){const d=await k(t,o,e,i);a.children||(a.children=[]),a.children.push(...d)}}return r.push(a),r},Ae=t=>{const{components:o,models:n,inverseAttributes:i,expressID:r}=t,s=i??["IsDecomposedBy","ContainsElements"];return I`<bim-table ${P(async h=>{if(!h)return;const a=o.get(L),l=[];for(const c of n){let e;if(r)e={data:{Entity:c.name!==""?c.name:c.uuid},children:await k(o,c,r,s)};else{const d=a.relationMaps[c.uuid],p=await c.getAllPropertiesOfType(te);if(!(d&&p))continue;const{expressID:g}=Object.values(p)[0];e={data:{Entity:c.name!==""?c.name:c.uuid},children:await k(o,c,g,s)}}l.push(e)}const m=h;m.addEventListener("cellcreated",({detail:c})=>{const e=c.cell.parentNode;if(!e)return;const d=e.querySelector("bim-table-cell[column='Entity']"),p=e.querySelector("bim-table-cell[column='Name']");!(p!=null&&p.data)&&d&&(d.style.gridColumn="1 / -1")}),m.columns=["Entity","Name"],m.data=l})} headers-hidden></bim-table>`},Re=(t,o=!0)=>{const n=E.create(Ae,t);if(o){const[,i]=n,{components:r}=t,s=r.get(v),u=r.get(L),h=()=>i({models:s.groups.values()});u.onRelationsIndexed.add(h),s.onFragmentsDisposed.add(h)}return n},Se=Object.freeze(Object.defineProperty({__proto__:null,relationsTree:Re},Symbol.toStringTag,{value:"Module"})),Te=(t,o)=>I`
    <bim-number-input @change=${i=>{const r=i.target;t.three instanceof O&&(t.three.near=r.value,t.three.updateProjectionMatrix())}} min="0.1" value=${o} max="10" step="0.1" slider></bim-number-input>
  `,ve=(t,o)=>I`
    <bim-number-input @change=${i=>{const r=i.target;t.three instanceof O&&(t.three.far=r.value,t.three.updateProjectionMatrix())}} min="300" value=${o} max="2000" step="10" slider></bim-number-input>
  `,Ee=(t,o)=>I`
    <bim-number-input @change=${i=>{const r=i.target;t.three instanceof O&&(t.three.fov=r.value,t.three.updateProjectionMatrix())}} min="10" value=${o} max="120" slider></bim-number-input>
  `,xe=(t,o)=>{if(!t.hasCameraControls())return o;const{controls:n}=t;return I`
    <bim-checkbox @change=${r=>{const s=r.target;n.dollyDragInverted=s.checked}} .checked=${o}></bim-checkbox>
  `},De=(t,o)=>{if(!t.hasCameraControls())return o;const{controls:n}=t;return I`
    <bim-number-input @change=${r=>{const s=r.target;n.dollySpeed=s.value}} min="0.5" value=${o} max="3" step="0.1" slider></bim-number-input>
  `},Pe=(t,o)=>{if(!t.hasCameraControls())return o;const{controls:n}=t;return I`
    <bim-number-input @change=${r=>{const s=r.target;n.truckSpeed=s.value}} min="0.5" value=${o} max="6" step="0.1" slider></bim-number-input>
  `},Le=(t,o)=>{if(!t.hasCameraControls())return o;const{controls:n}=t;return I`
    <bim-number-input @change=${r=>{const s=r.target;n.smoothTime=s.value}} min="0.01" value=${o} max="2" step="0.01" slider></bim-number-input>
  `},$e=(t,o)=>I`
    <bim-number-input @change=${i=>{const r=i.target;t.intensity=r.value}} min="0" value=${o} max="10" step="0.1" slider></bim-number-input>
  `,Oe=(t,o)=>I`
    <bim-color-input @input=${i=>{const r=i.target;t.color=new B(r.color)}} color=${o}></bim-color-input>
  `,Me=(t,o)=>{const{postproduction:n}=t,i=n.n8ao.configuration;return I`
    <bim-color-input @input=${s=>{const u=s.target;i.color=new B(u.color)}} color=${o}></bim-color-input>
  `},Fe=(t,o)=>{const{postproduction:n}=t;return I`
    <bim-checkbox @change=${r=>{const s=r.target;n.setPasses({ao:s.checked})}} .checked=${o}></bim-checkbox>
  `},ke=t=>{const{components:o}=t,n=o.get(ne);return I`<bim-table ${P(async r=>{var h,a,l,m,c;if(!r)return;const s=r;s.preserveStructureOnFilter=!0,s.dataTransform={Value:(e,d)=>{const p=d.World,g=n.list.get(p);if(!g)return e;const{scene:w,camera:f,renderer:A}=g,y=d.Name;if(y==="Near Frustum"&&typeof e=="number")return Te(f,e);if(y==="Far Frustum"&&typeof e=="number")return ve(f,e);if(y==="Field of View"&&typeof e=="number")return Ee(f,e);if(y==="Invert Drag"&&typeof e=="boolean")return xe(f,e);if(y==="Dolly Speed"&&typeof e=="number")return De(f,e);if(y==="Truck Speed"&&typeof e=="number")return Pe(f,e);if(y==="Smooth Time"&&typeof e=="number")return Le(f,e);if(y==="Intensity"&&typeof e=="number"){const b=d.Light,C=w.three.children.find(T=>T.uuid===b);return C&&C instanceof V?$e(C,e):e}if(y==="Color"&&typeof e=="string"){const b=d.Light,C=w.three.children.find(T=>T.uuid===b);if(C&&C instanceof V)return Oe(C,e);if(d.IsAOConfig&&A instanceof F)return Me(A,e)}return y==="Enabled"&&typeof e=="boolean"&&d.IsAOConfig&&A instanceof F?Fe(A,e):e}},s.addEventListener("cellcreated",({detail:e})=>{const d=e.cell.parentNode;if(!d)return;const p=d.querySelector("bim-table-cell[column='Name']"),g=d.querySelector("bim-table-cell[column='Value']");!(g!=null&&g.data)&&p&&(p.style.gridColumn="1 / -1")});const u=[];for(const[,e]of n.list){const{scene:d,camera:p,renderer:g}=e,w={data:{Name:e.uuid},children:[]};if(d){const f={data:{Name:"Scene"}},A=d.three.children.filter(b=>b instanceof oe);for(const b of A){const C={data:{Name:"Directional Light"},children:[{data:{Name:"Intensity",Value:b.intensity,World:e.uuid,Light:b.uuid}},{data:{Name:"Color",Value:`#${b.color.getHexString()}`,World:e.uuid,Light:b.uuid}}]};f.children||(f.children=[]),f.children.push(C)}const y=d.three.children.filter(b=>b instanceof re);for(const b of y){const C={data:{Name:"Ambient Light"},children:[{data:{Name:"Intensity",Value:b.intensity,World:e.uuid,Light:b.uuid}},{data:{Name:"Color",Value:`#${b.color.getHexString()}`,World:e.uuid,Light:b.uuid}}]};f.children||(f.children=[]),f.children.push(C)}f.children&&((h=f.children)==null?void 0:h.length)>0&&((a=w.children)==null||a.push(f))}if(p.three instanceof O){const f={data:{Name:"Perspective Camera"},children:[{data:{Name:"Near Frustum",Value:p.three.near,World:e.uuid}},{data:{Name:"Far Frustum",Value:p.three.far,World:e.uuid}},{data:{Name:"Field of View",Value:p.three.fov,World:e.uuid}}]};if(p.hasCameraControls()){const{controls:A}=p,y={dollyDragInverted:"Invert Drag",dollySpeed:"Dolly Speed",truckSpeed:"Truck Speed",smoothTime:"Smooth Time"};for(const b in y){const C=A[b];C!=null&&((l=f.children)==null||l.push({data:{Name:y[b],Value:C,World:e.uuid}}))}}(m=w.children)==null||m.push(f)}if(g instanceof F){const{postproduction:f}=g,A=f.n8ao.configuration,y={data:{Name:"Renderer"},children:[{data:{Name:"Ambient Oclussion"},children:[{data:{Name:"Enabled",Value:f.settings.ao??!1,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Color",Value:`#${A.color.getHexString()}`,World:e.uuid,IsAOConfig:!0}}]},{data:{Name:"Edges"}},{data:{Name:"Gloss"}}]};(c=w.children)==null||c.push(y)}u.push(w)}s.hiddenColumns=["World","Light","IsAOConfig"],s.data=u})} headers-hidden expanded></bim-table>`},_e=t=>E.create(ke,t),Ve=Object.freeze(Object.defineProperty({__proto__:null,worldsConfiguration:_e},Symbol.toStringTag,{value:"Module"})),He={...ae,...ue,...me,...Ne,...Se,...Ve};export{He as t};
