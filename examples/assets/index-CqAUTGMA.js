import{m as w,H as F,Q as le,z as L,_ as k,j as K,R as ue,J as S,g as Q,h as de,k as X,n as Z,p as ee,s as fe,I as te,t as ne,u as me,v as pe,w as ge,x as he,y as be,r as ye,A as Ie,a as oe,P as z,D as G,$ as R,K as Ce,S as we,U as Ne,C as W,l as xe,W as Ee,Y as Re}from"./template-BHX6Qr0d.js";const Ae={"jhon.doe@example.com":{name:"Jhon Doe",picture:"https://www.profilebakery.com/wp-content/uploads/2023/04/Profile-Image-AI.jpg"}},Se=(t,n)=>{const i=(n??Ae)[t],c=(i==null?void 0:i.name)??t,o=c.trim().split(/\s+/);let r,u;return o[0]&&o[0][0]&&(r=o[0][0].toUpperCase(),o[0][1]&&(u=o[0][1].toUpperCase())),o[1]&&o[1][0]&&(u=o[1][0].toUpperCase()),w`
  <div style="display: flex; gap: 0.25rem; overflow: hidden;">
    ${!(i!=null&&i.picture)&&(r||u)?w`
      <bim-label
        style=${le({borderRadius:"999px",padding:"0.375rem",backgroundColor:"var(--bim-ui_bg-contrast-20)",aspectRatio:"1",fontSize:"0.7rem"})}>${r}${u}</bim-label>
      `:null}
    <bim-label .img=${i==null?void 0:i.picture}>${c}</bim-label>
  </div>
`},Te=t=>{const{topic:n,styles:s,viewpoint:i,actions:c}=t,o={delete:!0,...c};return w`<bim-table @cellcreated=${({detail:u})=>{const{cell:a}=u;a.style.marginLeft="0"}} ${F(u=>{if(!u)return;const a=u;a.headersHidden=!0,a.hiddenColumns=["guid","author"],a.dataTransform={Comment:(m,p)=>{const{guid:e}=p;if(typeof e!="string")return m;const l=n.comments.get(e);if(!l)return m;const g=()=>{n.comments.delete(e)};return w`
        <div style="display: flex; flex-direction: column; gap: 0.25rem; flex: 1">
          <div style="display: flex; justify-content: space-between;">
            <div style="display: flex; gap: 0.375rem;">
              ${Se(l.author,s)}
              <bim-label style="color: var(--bim-ui_bg-contrast-40)">@ ${l.date.toDateString()}</bim-label>
            </div>
            <div>
              <style>
                #TCDBT {
                  background-color: transparent;
                  --bim-label--c: var(--bim-ui_bg-contrast-60)
                }

                #TCDBT:hover {
                  --bim-label--c: #FF5252;
                }
              </style>
              ${o!=null&&o.delete?w`<bim-button @click=${g} id="TCDBT" icon="majesticons:delete-bin"></bim-button>`:null}
            </div>
          </div>
          <bim-label style="margin-left: 1.7rem; white-space: normal">${l.comment}</bim-label>
        </div>
      `}};let d=n.comments.values();i&&(d=[...n.comments.values()].filter(m=>m.viewpoint===i)),a.data=[...d].map(m=>({data:{guid:m.guid,Comment:m.comment,author:(()=>{const p=s;if(!p)return m.author;const e=p[m.author];return(e==null?void 0:e.name)??m.author})()}}))})}><bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">This topic has no comments</bim-label></bim-table>`},De=(t,n=!0)=>{const s=L.create(Te,t);if(n){const{topic:i}=t,[c,o]=s;i.comments.onItemSet.add(()=>o()),i.comments.onItemUpdated.add(()=>o()),i.comments.onItemDeleted.add(()=>o()),i.comments.onCleared.add(()=>o())}return s},ve=Object.freeze(Object.defineProperty({__proto__:null,topicComments:De},Symbol.toStringTag,{value:"Module"})),$e=t=>{const{components:n,actions:s,tags:i}=t,c=(s==null?void 0:s.dispose)??!0,o=(s==null?void 0:s.download)??!0,r=(s==null?void 0:s.visibility)??!0,u=(i==null?void 0:i.schema)??!0,a=(i==null?void 0:i.viewDefinition)??!0,d=n.get(k),m=({detail:e})=>{const{cell:l}=e;l.style.padding="0.25rem 0"};return w`
    <bim-table ${F(e=>{if(!e)return;const l=e;l.hiddenColumns=["modelID"];const g=[];for(const[,h]of d.groups){if(!h)continue;const N={data:{Name:h.name||h.uuid,modelID:h.uuid}};g.push(N)}l.dataTransform={Name:(h,N)=>{const{modelID:C}=N;if(typeof C!="string")return h;const f=d.groups.get(C);if(!f)return C;const b={};for(const T of f.items)b[T.id]=T.ids;let y;const{schema:I}=f.ifcMetadata;u&&I&&(y=w`
            <bim-label style="background-color: var(--bim-ui_main-base); padding: 0 0.25rem; color: var(--bim-ui_main-contrast); border-radius: 0.25rem;">${I}</bim-label>
            `);let E;if(a&&"viewDefinition"in f.ifcMetadata){const T=f.ifcMetadata.viewDefinition;E=w`
            ${T.split(",").map(A=>w`<bim-label style="background-color: var(--bim-ui_main-base); padding: 0 0.25rem; color: var(--bim-ui_main-contrast); border-radius: 0.25rem;">${A}</bim-label>`)}
          `}let v;c&&(v=w`<bim-button @click=${()=>d.disposeGroup(f)} icon="mdi:delete"></bim-button>`);let M;r&&(M=w`<bim-button @click=${A=>{const H=n.get(K),V=A.target;H.set(V.hasAttribute("data-model-hidden"),b),V.toggleAttribute("data-model-hidden"),V.icon=V.hasAttribute("data-model-hidden")?"mdi:eye-off":"mdi:eye"}} icon="mdi:eye"></bim-button>`);let j;return o&&(j=w`<bim-button @click=${()=>{const A=document.createElement("input");A.type="file",A.accept=".ifc",A.multiple=!1,A.addEventListener("change",async()=>{if(!(A.files&&A.files.length===1))return;const H=A.files[0],V=await H.arrayBuffer(),ce=await n.get(ue).saveToIfc(f,new Uint8Array(V)),q=new File([ce],H.name),U=document.createElement("a");U.href=URL.createObjectURL(q),U.download=q.name,U.click(),URL.revokeObjectURL(U.href)}),A.click()}} icon="flowbite:download-solid"></bim-button>`),w`
         <div style="display: flex; flex: 1; gap: var(--bim-ui_size-4xs); justify-content: space-between; overflow: auto;">
          <div style="display: flex; flex-wrap: wrap; align-items: center; gap: 0 var(--bim-ui_size-4xs); flex-grow: 1; overflow: auto;">
            <div style="min-height: 1.75rem; overflow: auto; display: flex;">
              <bim-label style="white-space: normal;">${h}</bim-label>
            </div>
            <div style="display: flex; flex-wrap: wrap; gap: var(--bim-ui_size-4xs); overflow: auto;">
              ${y}
              ${E}
            </div>
          </div>
          <div style="display: flex; align-self: flex-start; flex-shrink: 0;">
            ${j}
            ${M}
            ${v}
          </div>
         </div>
        `}},l.data=g})} @cellcreated=${m} headers-hidden no-indentation>
      <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
        No models has been loaded yet
      </bim-label>
    </bim-table>
  `},Oe=(t,n=!0)=>{const s=L.create($e,t);if(n){const{components:i}=t,c=i.get(k),[,o]=s;c.onFragmentsLoaded.add(()=>setTimeout(()=>o())),c.onFragmentsDisposed.add(()=>o())}return s},Le=Object.freeze(Object.defineProperty({__proto__:null,modelsList:Oe},Symbol.toStringTag,{value:"Module"})),ie=["Name","ContainedInStructure","ForLayerSet","LayerThickness","HasProperties","HasAssociations","HasAssignments","HasPropertySets","PredefinedType","Quantities","ReferencedSource","Identification",t=>t.includes("Value"),t=>t.startsWith("Material"),t=>t.startsWith("Relating"),t=>{const n=["IsGroupedBy","IsDecomposedBy"];return t.startsWith("Is")&&!n.includes(t)}];async function J(t,n,s,i=ie,c=!1){const o=t.get(S),r=await n.getProperties(s);if(!r)return{data:{Entity:`${s} properties not found...`}};const u=o.relationMaps[n.uuid],a={data:{}};for(const d in r){const m=i.map(e=>typeof e=="string"?d===e:e(d)).includes(!0);if(!(d==="type"||m))continue;const p=r[d];if(p)if(p.type===5){a.children||(a.children=[]);const e=await J(t,n,p.value,i,c);a.children.push(e)}else if(typeof p=="object"&&!Array.isArray(p)){const{value:e,type:l}=p;if(c)l===1||l===2||l===3||(a.data[d]=e);else{const g=typeof e=="number"?Number(e.toFixed(3)):e;a.data[d]=g}}else if(Array.isArray(p))for(const e of p){if(e.type!==5)continue;a.children||(a.children=[]);const l=await J(t,n,e.value,i,c);a.children.push(l)}else if(d==="type"){const e=Q[p];a.data.Entity=e}else a.data[d]=p}if(u&&u.get(r.expressID)){const d=u.get(r.expressID);for(const m of i){const p=[];if(typeof m=="string"){const e=o._inverseAttributes.indexOf(m);e!==-1&&p.push(e)}else{const e=o._inverseAttributes.filter(l=>m(l));for(const l of e){const g=o._inverseAttributes.indexOf(l);p.push(g)}}for(const e of p){const l=d.get(e);if(l)for(const g of l){const h=await J(t,n,g,i,c);a.children||(a.children=[]),a.children.push(h)}}}}return a}const ke=t=>{const{components:n,fragmentIdMap:s,attributesToInclude:i,editable:c,tableDefinition:o}=t,r=n.get(k);let u;return typeof i=="function"?u=i(ie):u=i,w`<bim-table ${F(async d=>{if(!d)return;const m=d,p=[],e=[];for(const l in s){const g=r.list.get(l);if(!(g&&g.group))continue;const h=g.group,N=e.find(C=>C.model===h);if(N)for(const C of s[l])N.expressIDs.add(C);else{const C={model:h,expressIDs:new Set(s[l])};e.push(C)}}for(const l of e){const{model:g,expressIDs:h}=l;for(const N of h){const C=await J(n,g,N,u,c);p.push(C)}}m.dataTransform=o,m.data=p,m.columns=[{name:"Entity",width:"minmax(15rem, 1fr)"}]})}></bim-table>`},Me=t=>L.create(ke,t),Ve=Object.freeze(Object.defineProperty({__proto__:null,entityAttributes:Me},Symbol.toStringTag,{value:"Module"}));let $;const Pe=t=>{const{components:n,classifications:s}=t,i=n.get(de),c=n.get(K);$||($=document.createElement("bim-table"),$.headersHidden=!0,$.hiddenColumns=["system"],$.columns=["Name",{name:"Actions",width:"auto"}],$.dataTransform={Actions:(r,u)=>{const{system:a,Name:d}=u;if(!(typeof a=="string"&&typeof d=="string"))return r;const m=i.list[a];if(!(m&&m[d]))return r;const p=m[d],{map:e}=p;return w`
          <div>
            <bim-checkbox checked @change=${g=>{const h=g.target;c.set(h.value,e)}}></bim-checkbox>
          </div>
        `}});const o=[];for(const r of s){const u=typeof r=="string"?r:r.system,a=typeof r=="string"?r:r.label,d=i.list[u];d&&o.push({data:{Name:a,system:u},children:Object.keys(d).map(m=>({data:{Name:m,system:u,Actions:""}}))})}return $.data=o,w`${$}`},Ge=(t,n=!0)=>{const s=L.create(Pe,t);if(n){const{components:i}=t,c=i.get(k),[,o]=s;c.onFragmentsDisposed.add(()=>o())}return s},_e=Object.freeze(Object.defineProperty({__proto__:null,classificationTree:Ge},Symbol.toStringTag,{value:"Module"})),se=async(t,n,s)=>{var u,a,d,m;const i=t.get(S),c={data:{Name:(u=s.Name)==null?void 0:u.value},children:[{data:{Name:"Identification",Value:(a=s.Identification)==null?void 0:a.value}},{data:{Name:"Name",Value:(d=s.Name)==null?void 0:d.value}},{data:{Name:"Description",Value:(m=s.Description)==null?void 0:m.value}}]},o=i.getEntityRelations(n,s.expressID,"IsNestedBy");if(!o)return c;c.children||(c.children=[]);const r=[];c.children.push({data:{Name:"Tasks"},children:r});for(const p of o){const e=await n.getProperties(p);if(!e)continue;const l=await se(t,n,e);r.push(l)}return c},Fe=async(t,n,s)=>{const i=[];for(const o of s){const r=await se(t,n,o);i.push(r)}return{data:{Name:"Tasks"},children:i}},We=async(t,n)=>{var i,c;const s={data:{Name:"Classifications"}};for(const o of n){const{value:r}=o.ReferencedSource,u=await t.getProperties(r);if(!u)continue;const a={data:{Name:u.Name.value},children:[{data:{Name:"Identification",Value:((i=o.Identification)==null?void 0:i.value)||((c=o.ItemReference)==null?void 0:c.value)}},{data:{Name:"Name",Value:o.Name.value}}]};s.children||(s.children=[]),s.children.push(a)}return s},je=async(t,n)=>{const s={data:{Name:"Materials"}};for(const i of n){if(i.type===X){const c=i.ForLayerSet.value,o=await t.getProperties(c);if(!o)continue;for(const r of o.MaterialLayers){const{value:u}=r,a=await t.getProperties(u);if(!a)continue;const d=await t.getProperties(a.Material.value);if(!d)continue;const m={data:{Name:"Layer"},children:[{data:{Name:"Thickness",Value:a.LayerThickness.value}},{data:{Name:"Material",Value:d.Name.value}}]};s.children||(s.children=[]),s.children.push(m)}}if(i.type===Z)for(const c of i.Materials){const{value:o}=c,r=await t.getProperties(o);if(!r)continue;const u={data:{Name:"Name",Value:r.Name.value}};s.children||(s.children=[]),s.children.push(u)}if(i.type===ee){const c={data:{Name:"Name",Value:i.Name.value}};s.children||(s.children=[]),s.children.push(c)}}return s},He={IFCLENGTHMEASURE:"LENGTHUNIT",IFCAREAMEASURE:"AREAUNIT",IFCVOLUMEMEASURE:"VOLUMEUNIT",IFCPLANEANGLEMEASURE:"PLANEANGLEUNIT"},Ue={MILLIMETRE:{symbol:"mm",digits:0},METRE:{symbol:"m",digits:2},KILOMETRE:{symbol:"km",digits:2},SQUARE_METRE:{symbol:"m²",digits:2},CUBIC_METRE:{symbol:"m³",digits:2},DEGREE:{symbol:"°",digits:2},RADIAN:{symbol:"rad",digits:2},GRAM:{symbol:"g",digits:0},KILOGRAM:{symbol:"kg",digits:2},MILLISECOND:{symbol:"ms",digits:0},SECOND:{symbol:"s",digits:0}},re=async(t,n)=>{var c,o,r;const s=Object.values(await t.getAllPropertiesOfType(fe))[0];let i;for(const u of s.Units){const a=await t.getProperties(u.value);if(a&&((c=a.UnitType)==null?void 0:c.value)===He[n]){i=`${((o=a.Prefix)==null?void 0:o.value)??""}${((r=a.Name)==null?void 0:r.value)??""}`;break}}return i?Ue[i]:null},ze=async(t,n,s)=>{const{displayUnits:i}=s,c={data:{Name:"PropertySets"}};for(const o of n){const r={data:{Name:o.Name.value}};if(o.type===te){for(const u of o.HasProperties){const{value:a}=u,d=await t.getProperties(a);if(!d)continue;const m=Object.keys(d).find(g=>g.includes("Value"));if(!(m&&d[m]))continue;let p=d[m].value,e="";if(i){const{name:g}=d[m],h=await re(t,g)??{};e=h.symbol,p=d[m].value,typeof p=="number"&&h.digits&&(p=p.toFixed(h.digits))}const l={data:{Name:d.Name.value,Value:`${p} ${e??""}`}};r.children||(r.children=[]),r.children.push(l)}r.children&&(c.children||(c.children=[]),c.children.push(r))}}return c},Be=async(t,n,s)=>{const{displayUnits:i}=s,c={data:{Name:"QuantitySets"}};for(const o of n){const r={data:{Name:o.Name.value}};if(o.type===ne){for(const u of o.Quantities){const{value:a}=u,d=await t.getProperties(a);if(!d)continue;const m=Object.keys(d).find(g=>g.includes("Value"));if(!(m&&d[m]))continue;let p=d[m].value,e="";if(i){const{name:g}=d[m],h=await re(t,g)??{};e=h.symbol,p=d[m].value,typeof p=="number"&&h.digits&&(p=p.toFixed(h.digits))}const l={data:{Name:d.Name.value,Value:`${p} ${e??""}`}};r.children||(r.children=[]),r.children.push(l)}r.children&&(c.children||(c.children=[]),c.children.push(r))}}return c},Je=["OwnerHistory","ObjectPlacement","CompositionType"],ae=async(t,n)=>{const i={...{groupName:"Attributes",includeClass:!1},...n},{groupName:c,includeClass:o}=i,r={data:{Name:c}};o&&(r.children||(r.children=[]),r.children.push({data:{Name:"Class",Value:Q[t.type]}}));for(const u in t){if(Je.includes(u))continue;const a=t[u];if(a&&typeof a=="object"&&!Array.isArray(a)){if(a.type===me)continue;const d={data:{Name:u,Value:a.value}};r.children||(r.children=[]),r.children.push(d)}}return r},P=(t,...n)=>{t.children||(t.children=[]),t.children.push(...n)},Qe=async(t,n,s,i,c)=>{const r=t.get(S).getEntityRelations(n,s,"IsDefinedBy");if(r){const u=[],a=[];for(const p of r){const e=await n.getProperties(p);e&&(e.type===te&&u.push(e),e.type===ne&&a.push(e))}const d=await ze(n,u,c);d.children&&P(i,d);const m=await Be(n,a,c);m.children&&P(i,m)}},Ye=async(t,n,s,i)=>{const o=t.get(S).getEntityRelations(n,s,"HasAssociations");if(o){const r=[],u=[];for(const m of o){const p=await n.getProperties(m);p&&(p.type===pe&&r.push(p),(p.type===X||p.type===ge||p.type===he||p.type===ee||p.type===Z)&&u.push(p))}const a=await We(n,r);a.children&&P(i,a);const d=await je(n,u);d.children&&P(i,d)}},qe=async(t,n,s,i)=>{const o=t.get(S).getEntityRelations(n,s,"HasAssignments");if(o){const r=[];for(const a of o){const d=await n.getProperties(a);d&&d.type===be&&r.push(d)}const u=await Fe(t,n,r);u.children&&P(i,u)}},Ke=async(t,n,s,i)=>{const o=t.get(S).getEntityRelations(n,s,"ContainedInStructure");if(o&&o[0]){const r=o[0],u=await n.getProperties(r);if(u){const a=await ae(u,{groupName:"SpatialContainer"});P(i,a)}}};let B={};const Xe=async(t,n,s)=>{var u;const i=t.get(S),c=t.get(k),o=c.getModelIdMap(n);Object.keys(n).length===0&&(B={});const r=[];for(const a in o){const d=c.groups.get(a);if(!d)continue;const m=i.relationMaps[d.uuid];if(!m)continue;a in B||(B[a]=new Map);const p=B[a],e=o[a];for(const l of e){let g=p.get(l);if(g){r.push(g);continue}const h=await d.getProperties(l);if(!h)continue;g={data:{Name:(u=h.Name)==null?void 0:u.value}},r.push(g),p.set(l,g);const N=await ae(h,{includeClass:!0});g.children||(g.children=[]),g.children.push(N),m.get(l)&&(await Qe(t,d,l,g,s),await Ye(t,d,l,g),await qe(t,d,l,g),await Ke(t,d,l,g))}}return r},Ze=t=>{const n={emptySelectionWarning:!0,...t},{components:s,fragmentIdMap:i,emptySelectionWarning:c}=n;return w`
    <bim-table @cellcreated=${({detail:u})=>{const{cell:a}=u;a.column==="Name"&&!("Value"in a.rowData)&&(a.style.gridColumn="1 / -1")}} ${F(async u=>{if(!u)return;const a=u;a.columns=[{name:"Name",width:"12rem"}],a.headersHidden=!0,a.loadFunction=()=>Xe(s,i,t),await a.loadData(!0)&&a.dispatchEvent(new Event("datacomputed"))})}>
      ${c?w`
            <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
              Select some elements to display its properties
            </bim-label>
          `:null}
    </bim-table>
  `},et=t=>L.create(Ze,t),tt=Object.freeze(Object.defineProperty({__proto__:null,elementProperties:et},Symbol.toStringTag,{value:"Module"})),Y=async(t,n,s,i)=>{var d;const c=[],o=t.get(S),r=await n.getProperties(s);if(!r)return c;const{type:u}=r,a={data:{Entity:Q[u],Name:(d=r.Name)==null?void 0:d.value,modelID:n.uuid,expressID:s}};for(const m of i){const p=o.getEntityRelations(n,s,m);if(!p)continue;a.children||(a.children=[]),a.data.relations=JSON.stringify(p);const e={};for(const l of p){const g=await Y(t,n,l,i);for(const h of g)if(h.data.relations)a.children.push(h);else{const N=n.data.get(l);if(!N){a.children.push(h);continue}const C=N[1][1],f=Q[C];f in e||(e[f]=[]),h.data.Entity=h.data.Name,delete h.data.Name,e[f].push(h)}}for(const l in e){const g=e[l],h=g.map(C=>C.data.expressID),N={data:{Entity:l,modelID:n.uuid,relations:JSON.stringify(h)},children:g};a.children.push(N)}}return c.push(a),c},nt=async(t,n,s,i)=>{const c=t.get(S),o=[];for(const r of n){let u;if(i)u={data:{Entity:r.name!==""?r.name:r.uuid},children:await Y(t,r,i,s)};else{const a=c.relationMaps[r.uuid],d=await r.getAllPropertiesOfType(Ie);if(!(a&&d))continue;const{expressID:m}=Object.values(d)[0];u={data:{Entity:r.name!==""?r.name:r.uuid},children:await Y(t,r,m,s)}}o.push(u)}return o};let D;const ot=(t,n)=>{const s=t.get(k),{modelID:i,expressID:c,relations:o}=n.data;if(!i)return null;const r=s.groups.get(i);return r?r.getFragmentMap([c,...JSON.parse(o??"[]")]):null},it=t=>{const{components:n,models:s,expressID:i}=t,c=t.selectHighlighterName??"select",o=t.hoverHighlighterName??"hover";D||(D=document.createElement("bim-table"),D.hiddenColumns=["modelID","expressID","relations"],D.columns=["Entity","Name"],D.headersHidden=!0,D.addEventListener("cellcreated",({detail:u})=>{const{cell:a}=u;a.column==="Entity"&&!("Name"in a.rowData)&&(a.style.gridColumn="1 / -1")})),D.addEventListener("rowcreated",u=>{u.stopImmediatePropagation();const{row:a}=u.detail,d=n.get(ye),m=ot(n,a);m&&Object.keys(m).length!==0&&(a.onmouseover=()=>{o&&(a.style.backgroundColor="var(--bim-ui_bg-contrast-20)",d.highlightByID(o,m,!0,!1,d.selection[c]??{}))},a.onmouseout=()=>{a.style.backgroundColor="",d.clear(o)},a.onclick=()=>{c&&d.highlightByID(c,m,!0,!0)})});const r=t.inverseAttributes??["IsDecomposedBy","ContainsElements"];return nt(n,s,r,i).then(u=>D.data=u),w`${D}`},st=(t,n=!0)=>{const s=L.create(it,t);if(n){const[,i]=s,{components:c}=t,o=c.get(k),r=c.get(S),u=()=>i({models:o.groups.values()});r.onRelationsIndexed.add(u),o.onFragmentsDisposed.add(u)}return s},rt=Object.freeze(Object.defineProperty({__proto__:null,relationsTree:st},Symbol.toStringTag,{value:"Module"})),_=(t,n)=>[...t.get(xe).list.values()].find(c=>c.world===n),at=(t,n)=>w`
    <bim-color-input @input=${i=>{const c=i.target;t.color=new W(c.color)}} color=${n}></bim-color-input>
  `,ct=(t,n)=>{const{postproduction:s}=t,i=s.n8ao.configuration;return w`
    <bim-color-input @input=${o=>{const r=o.target;i.color=new W(r.color)}} color=${n}></bim-color-input>
  `},lt=(t,n)=>{const{color:s,opacity:i}=JSON.parse(n),{postproduction:c}=t,{customEffects:o}=c;return w`
    <bim-color-input @input=${u=>{const{color:a,opacity:d}=u.target;o.lineColor=new W(a).getHex(),d&&(o.opacity=d/100)}} color=${s} opacity=${i*100}></bim-color-input>
  `},ut=(t,n)=>w`
    <bim-color-input @input=${i=>{const c=i.target,o=new W(c.color);t.material.uniforms.uColor.value=o}} color=${n}></bim-color-input>
  `,dt=(t,n)=>{const{postproduction:s}=t;return w`
    <bim-checkbox @change=${c=>{const o=c.target;s.setPasses({ao:o.checked})}} .checked=${n}></bim-checkbox>
  `},ft=(t,n)=>{const{postproduction:s}=t;return w`
    <bim-checkbox @change=${c=>{const o=c.target;s.setPasses({gamma:o.checked})}} .checked=${n}></bim-checkbox>
  `},mt=(t,n)=>{const{postproduction:s}=t;return w`
    <bim-checkbox @change=${c=>{const o=c.target;s.setPasses({custom:o.checked})}} .checked=${n}></bim-checkbox>
  `},O=(t,n,s,i=()=>{})=>w`
    <bim-checkbox .checked="${s}" @change="${o=>{const u=o.target.checked;t[n]=u,i(u)}}"></bim-checkbox> 
  `,x=(t,n,s,i)=>{const c={slider:!1,min:0,max:100,step:1,prefix:null,suffix:null,onInputSet:()=>{},...i},{slider:o,min:r,max:u,step:a,suffix:d,prefix:m,onInputSet:p}=c;return w`
    <bim-number-input
      .pref=${m}
      .suffix=${d}
      .slider=${o} 
      min=${r} 
      value="${s}" 
      max=${u} 
      step=${a} 
      @change="${l=>{const h=l.target.value;t[n]=h,p(h)}}"
    ></bim-number-input> 
  `},pt=t=>{const{components:n}=t,s=n.get(oe);return w`<bim-table ${F(async c=>{var u,a,d,m,p;if(!c)return;const o=c;o.preserveStructureOnFilter=!0,o.dataTransform={Value:(e,l)=>{const g=l.World,h=s.list.get(g);if(!h)return e;const{scene:N,camera:C,renderer:f}=h,b=l.Name;if(b==="Grid"&&l.IsGridConfig&&typeof e=="boolean"){const y=_(n,h);return y?O(y,"visible",e):e}if(b==="Color"&&l.IsGridConfig&&typeof e=="string"){const y=_(n,h);return y?ut(y,e):e}if(b==="Distance"&&l.IsGridConfig&&typeof e=="number"){const y=_(n,h);return y?x(y.material.uniforms.uDistance,"value",e,{slider:!0,min:300,max:1e3}):e}if(b==="Size"&&l.IsGridConfig&&typeof e=="string"){const y=_(n,h);if(!y)return e;const{x:I,y:E}=JSON.parse(e),v=x(y.material.uniforms.uSize1,"value",I,{slider:!0,suffix:"m",prefix:"A",min:1,max:20}),M=x(y.material.uniforms.uSize2,"value",E,{slider:!0,suffix:"m",prefix:"B",min:1,max:20});return w`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${v}${M}</div>
          `}if(b==="Near Frustum"&&C.three instanceof z&&typeof e=="number"){const y=C.three;return x(C.three,"near",e,{slider:!0,min:.1,max:10,step:.1,onInputSet:()=>y.updateProjectionMatrix()})}if(b==="Far Frustum"&&C.three instanceof z&&typeof e=="number"){const y=C.three;return x(C.three,"far",e,{slider:!0,min:300,max:2e3,step:10,onInputSet:()=>y.updateProjectionMatrix()})}if(b==="Field of View"&&C.three instanceof z&&typeof e=="number"){const y=C.three;return x(C.three,"fov",e,{slider:!0,min:10,max:120,onInputSet:()=>y.updateProjectionMatrix()})}if(b==="Invert Drag"&&C.hasCameraControls()&&typeof e=="boolean")return O(C.controls,"dollyDragInverted",e);if(b==="Dolly Speed"&&C.hasCameraControls()&&typeof e=="number")return x(C.controls,"dollySpeed",e,{slider:!0,min:.5,max:3,step:.1});if(b==="Truck Speed"&&C.hasCameraControls()&&typeof e=="number")return x(C.controls,"truckSpeed",e,{slider:!0,min:.5,max:6,step:.1});if(b==="Smooth Time"&&C.hasCameraControls()&&typeof e=="number")return x(C.controls,"smoothTime",e,{slider:!0,min:.01,max:2,step:.01});if(b==="Intensity"&&typeof e=="number"){if(l.Light&&typeof l.Light=="string"){const y=N.three.children.find(I=>I.uuid===l.Light);return y&&y instanceof G?x(y,"intensity",e,{slider:!0,min:0,max:10,step:.1}):e}if(l.IsAOConfig&&f instanceof R)return x(f.postproduction.n8ao.configuration,"intensity",e,{slider:!0,max:16,step:.1})}if(b==="Color"&&typeof e=="string"){const y=l.Light,I=N.three.children.find(E=>E.uuid===y);if(I&&I instanceof G)return at(I,e);if(l.IsAOConfig&&f instanceof R)return ct(f,e)}if(b==="Ambient Oclussion"&&typeof e=="boolean"&&l.IsAOConfig&&f instanceof R)return dt(f,e);if(b==="Half Resolution"&&l.IsAOConfig&&f instanceof R&&typeof e=="boolean")return O(f.postproduction.n8ao.configuration,"halfRes",e);if(b==="Screen Space Radius"&&l.IsAOConfig&&f instanceof R&&typeof e=="boolean")return O(f.postproduction.n8ao.configuration,"screenSpaceRadius",e);if(b==="Radius"&&l.IsAOConfig&&f instanceof R&&typeof e=="number")return x(f.postproduction.n8ao.configuration,"aoRadius",e,{slider:!0,max:2,step:.1});if(b==="Denoise Samples"&&l.IsAOConfig&&f instanceof R&&typeof e=="number")return x(f.postproduction.n8ao.configuration,"denoiseSamples",e,{slider:!0,min:1,max:16});if(b==="Samples"&&l.IsAOConfig&&f instanceof R&&typeof e=="number")return x(f.postproduction.n8ao.configuration,"aoSamples",e,{slider:!0,min:1,max:16});if(b==="Denoise Radius"&&l.IsAOConfig&&f instanceof R&&typeof e=="number")return x(f.postproduction.n8ao.configuration,"denoiseRadius",e,{slider:!0,min:0,max:16,step:.1});if(b==="Distance Falloff"&&l.IsAOConfig&&f instanceof R&&typeof e=="number")return x(f.postproduction.n8ao.configuration,"distanceFalloff",e,{slider:!0,min:0,max:4,step:.1});if(b==="Directional Light"&&l.Light&&typeof l.Light=="string"&&typeof e=="boolean"){const y=N.three.children.find(I=>I.uuid===l.Light);return y&&y instanceof G?O(y,"visible",e):e}if(b==="Ambient Light"&&l.Light&&typeof l.Light=="string"&&typeof e=="boolean"){const y=N.three.children.find(I=>I.uuid===l.Light);return y&&y instanceof G?O(y,"visible",e):e}if(b==="Position"&&l.Light&&typeof l.Light=="string"&&typeof e=="string"){const y=N.three.children.find(A=>A.uuid===l.Light);if(!(y&&y instanceof G))return e;const{x:I,y:E,z:v}=JSON.parse(e),M=x(y.position,"x",I,{slider:!0,prefix:"X",suffix:"m",min:-50,max:50}),j=x(y.position,"y",E,{slider:!0,prefix:"Y",suffix:"m",min:-50,max:50}),T=x(y.position,"z",v,{slider:!0,prefix:"Z",suffix:"m",min:-50,max:50});return w`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${M}${j}${T}</div>
          `}return b==="Custom Effects"&&l.IsCEConfig&&f instanceof R&&typeof e=="boolean"?mt(f,e):b==="Color"&&l.IsOutlineConfig&&f instanceof R&&typeof e=="string"?lt(f,e):b==="Tolerance"&&l.IsOutlineConfig&&f instanceof R&&typeof e=="number"?x(f.postproduction.customEffects,"tolerance",e,{slider:!0,min:0,max:6,step:.01}):b==="Outline"&&l.IsOutlineConfig&&f instanceof R&&typeof e=="boolean"?O(f.postproduction.customEffects,"outlineEnabled",e):b==="Gloss"&&l.IsGlossConfig&&f instanceof R&&typeof e=="boolean"?O(f.postproduction.customEffects,"glossEnabled",e):b==="Min"&&l.IsGlossConfig&&f instanceof R&&typeof e=="number"?x(f.postproduction.customEffects,"minGloss",e,{slider:!0,min:-.5,max:.5,step:.01}):b==="Max"&&l.IsGlossConfig&&f instanceof R&&typeof e=="number"?x(f.postproduction.customEffects,"maxGloss",e,{slider:!0,min:-.5,max:.5,step:.01}):b==="Exponent"&&l.IsGlossConfig&&f instanceof R&&typeof e=="number"?x(f.postproduction.customEffects,"glossExponent",e,{slider:!0,min:0,max:5,step:.01}):b==="Gamma Correction"&&l.IsGammaConfig&&f instanceof R&&typeof e=="boolean"?ft(f,e):e}},o.addEventListener("cellcreated",({detail:e})=>{const l=e.cell.parentNode;if(!l)return;const g=l.querySelector("bim-table-cell[column='Name']"),h=l.querySelector("bim-table-cell[column='Value']");g&&!h&&(g.style.gridColumn="1 / -1")});const r=[];for(const[,e]of s.list){const{scene:l,camera:g,renderer:h}=e,N=_(n,e),C={data:{Name:e instanceof Ce&&e.name||e.uuid},children:[]};if(l){const f={data:{Name:"Scene"}};if(N){const I={data:{Name:"Grid",Value:N.three.visible,World:e.uuid,IsGridConfig:!0},children:[{data:{Name:"Color",get Value(){return`#${N.material.uniforms.uColor.value.getHexString()}`},World:e.uuid,IsGridConfig:!0}},{data:{Name:"Size",get Value(){const E=N.material.uniforms.uSize1.value,v=N.material.uniforms.uSize2.value;return JSON.stringify({x:E,y:v})},World:e.uuid,IsGridConfig:!0}},{data:{Name:"Distance",Value:N.material.uniforms.uDistance.value,World:e.uuid,IsGridConfig:!0}}]};f.children||(f.children=[]),f.children.push(I)}const b=l.three.children.filter(I=>I instanceof we);for(const I of b){const E={data:{Name:"Directional Light",Value:I.visible,World:e.uuid,Light:I.uuid},children:[{data:{Name:"Position",Value:JSON.stringify(I.position),World:e.uuid,Light:I.uuid}},{data:{Name:"Intensity",Value:I.intensity,World:e.uuid,Light:I.uuid}},{data:{Name:"Color",Value:`#${I.color.getHexString()}`,World:e.uuid,Light:I.uuid}}]};f.children||(f.children=[]),f.children.push(E)}const y=l.three.children.filter(I=>I instanceof Ne);for(const I of y){const E={data:{Name:"Ambient Light",Value:I.visible,World:e.uuid,Light:I.uuid},children:[{data:{Name:"Intensity",Value:I.intensity,World:e.uuid,Light:I.uuid}},{data:{Name:"Color",Value:`#${I.color.getHexString()}`,World:e.uuid,Light:I.uuid}}]};f.children||(f.children=[]),f.children.push(E)}f.children&&((u=f.children)==null?void 0:u.length)>0&&((a=C.children)==null||a.push(f))}if(g.three instanceof z){const f={data:{Name:"Perspective Camera"},children:[{data:{Name:"Near Frustum",Value:g.three.near,World:e.uuid}},{data:{Name:"Far Frustum",Value:g.three.far,World:e.uuid}},{data:{Name:"Field of View",Value:g.three.fov,World:e.uuid}}]};if(g.hasCameraControls()){const{controls:b}=g,y={dollyDragInverted:"Invert Drag",dollySpeed:"Dolly Speed",truckSpeed:"Truck Speed",smoothTime:"Smooth Time"};for(const I in y){const E=b[I];E!=null&&((d=f.children)==null||d.push({data:{Name:y[I],Value:E,World:e.uuid}}))}}(m=C.children)==null||m.push(f)}if(h instanceof R){const{postproduction:f}=h,b=f.n8ao.configuration,y={data:{Name:"Renderer"},children:[{data:{Name:"Gamma Correction",Value:f.settings.gamma??!1,World:e.uuid,IsGammaConfig:!0}},{data:{Name:"Ambient Oclussion",Value:f.settings.ao??!1,World:e.uuid,IsAOConfig:!0},children:[{data:{Name:"Samples",Value:b.aoSamples,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Color",Value:`#${b.color.getHexString()}`,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Half Resolution",Value:b.halfRes,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Screen Space Radius",Value:b.screenSpaceRadius,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Radius",Value:b.aoRadius,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Intensity",Value:b.intensity,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Distance Falloff",Value:b.distanceFalloff,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Samples",Value:b.denoiseSamples,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Radius",Value:b.denoiseRadius,World:e.uuid,IsAOConfig:!0}}]},{data:{Name:"Custom Effects",Value:f.settings.custom??!1,World:e.uuid,IsCEConfig:!0},children:[{data:{Name:"Gloss",Value:f.customEffects.glossEnabled,World:e.uuid,IsGlossConfig:!0},children:[{data:{Name:"Min",Value:f.customEffects.minGloss,World:e.uuid,IsGlossConfig:!0}},{data:{Name:"Max",Value:f.customEffects.maxGloss,World:e.uuid,IsGlossConfig:!0}},{data:{Name:"Exponent",Value:f.customEffects.glossExponent,World:e.uuid,IsGlossConfig:!0}}]},{data:{Name:"Outline",Value:f.customEffects.outlineEnabled,World:e.uuid,IsOutlineConfig:!0},children:[{data:{Name:"Color",get Value(){const I=new W(f.customEffects.lineColor),E=f.customEffects.opacity;return JSON.stringify({color:`#${I.getHexString()}`,opacity:E})},World:e.uuid,IsOutlineConfig:!0}},{data:{Name:"Tolerance",Value:f.customEffects.tolerance,World:e.uuid,IsOutlineConfig:!0}}]}]}]};(p=C.children)==null||p.push(y)}r.push(C)}o.columns=[{name:"Name",width:"11rem"}],o.hiddenColumns=["World","Light","IsAOConfig","IsCEConfig","IsGlossConfig","IsOutlineConfig","IsGammaConfig","IsGridConfig"],o.data=r})} headers-hidden expanded></bim-table>`},gt=(t,n=!0)=>{const s=L.create(pt,t);if(n){const[i]=s,c=()=>s[1](),{components:o}=t,r=o.get(oe);r.onDisposed.add(i.remove);for(const[,u]of r.list)u.onDisposed.add(c);i.addEventListener("disconnected",()=>{r.onDisposed.remove(i.remove);for(const[,u]of r.list)u.onDisposed.remove(c)})}return s},ht=Object.freeze(Object.defineProperty({__proto__:null,worldsConfiguration:gt},Symbol.toStringTag,{value:"Module"})),It={...Le,...Ve,..._e,...tt,...rt,...ht,...Ee,...ve,...Re};export{It as t};
