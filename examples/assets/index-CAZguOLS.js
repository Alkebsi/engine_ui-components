import{b as V,h as w,J as $,l as R,W as _,j as J,A as B,q,r as K,C as P,P as T,s as E,x as O,t as Q,v as X,w as Y,g as L,u as Z}from"./template-DtWW1qyz.js";const U=o=>{const{components:i}=o,s=i.get(V),a=document.createElement("bim-table");a.columns=["Model"],a.headersHidden=!0;const l=[];for(const[,r]of s.groups){if(!r)continue;const f={data:{Model:r.name||r.uuid,Actions:r.uuid}};l.push(f)}return a.dataTransform={Actions:r=>{if(typeof r!="string")return r;const f=s.groups.get(r);return f?w`
        <bim-button @click=${m=>{f.visible=!f.visible;const S=m.target;S.icon=f.visible?"mdi:eye":"mdi:eye-off"}} icon="mdi:eye"></bim-button>
        <bim-button @click=${()=>s.disposeGroup(f)} icon="mdi:delete"></bim-button>
      `:r}},a.columns=["Model",{name:"Actions",width:"auto"}],a.data=l,w`
    <div>
      ${l.length===0?w`<bim-label>No models has been loaded yet</bim-label>`:a}
    </div>
  `},v=(o,i=!0)=>{const s=$.create(U,o);if(i){const{components:a}=o,l=a.get(V),[,r]=s;l.onFragmentsLoaded.add(()=>setTimeout(()=>r())),l.onFragmentsDisposed.add(()=>r())}return s},ee=Object.freeze(Object.defineProperty({__proto__:null,modelsList:v},Symbol.toStringTag,{value:"Module"})),j=["Name","ContainedInStructure","ForLayerSet","LayerThickness","HasProperties","HasAssociations","HasAssignments","HasPropertySets","PredefinedType","Quantities","ReferencedSource","Identification",o=>o.includes("Value"),o=>o.startsWith("Material"),o=>o.startsWith("Relating"),o=>{const i=["IsGroupedBy","IsDecomposedBy"];return o.startsWith("Is")&&!i.includes(o)}];async function D(o,i,s,a=j,l=!1){const r=o.get(_),f=await i.getProperties(s);if(!f)return{data:{Entity:`${s} properties not found...`}};const g=r.relationMaps[i.uuid],b={data:{}};for(const m in f){const S=a.map(e=>typeof e=="string"?m===e:e(m)).includes(!0);if(!(m==="type"||S))continue;const y=f[m];if(y)if(y.type===5){b.children||(b.children=[]);const e=await D(o,i,y.value,a,l);b.children.push(e)}else if(typeof y=="object"&&!Array.isArray(y)){const{value:e,type:t}=y;if(l)t===1||t===2||t===3||(b.data[m]=e);else{const h=typeof e=="number"?Number(e.toFixed(3)):e;b.data[m]=h}}else if(Array.isArray(y))for(const e of y){if(e.type!==5)continue;b.children||(b.children=[]);const t=await D(o,i,e.value,a,l);b.children.push(t)}else if(m==="type"){const e=J[y];b.data.Entity=e}else b.data[m]=y}if(g&&g.get(f.expressID)){const m=g.get(f.expressID);for(const S of a){const y=[];if(typeof S=="string"){const e=r._inverseAttributes.indexOf(S);e!==-1&&y.push(e)}else{const e=r._inverseAttributes.filter(t=>S(t));for(const t of e){const h=r._inverseAttributes.indexOf(t);y.push(h)}}for(const e of y){const t=m.get(e);if(t)for(const h of t){const C=await D(o,i,h,a,l);b.children||(b.children=[]),b.children.push(C)}}}}return b}const te=o=>{const{components:i,fragmentIdMap:s,attributesToInclude:a,editable:l,tableDefinition:r}=o,f=i.get(V);let g;return typeof a=="function"?g=a(j):g=a,w`<bim-table ${R(async m=>{if(!m)return;const S=m,y=[],e=[];for(const t in s){const h=f.list.get(t);if(!(h&&h.group))continue;const C=h.group,x=e.find(p=>p.model===C);if(x)for(const p of s[t])x.expressIDs.add(p);else{const p={model:C,expressIDs:new Set(s[t])};e.push(p)}}for(const t of e){const{model:h,expressIDs:C}=t;for(const x of C){const p=await D(i,h,x,g,l);y.push(p)}}S.dataTransform=r,S.data=y,S.columns=[{name:"Entity",width:"minmax(15rem, 1fr)"}]})}></bim-table>`},ne=o=>$.create(te,o),oe=Object.freeze(Object.defineProperty({__proto__:null,entityAttributes:ne},Symbol.toStringTag,{value:"Module"}));function ie(o){const i=Object.keys(o).pop();return i&&o[i].length>0?o[i][0]:""}function M(o){return o.map(i=>{const s={data:{System:ie(i.filter)}};return i.children&&i.children.length>0&&(s.children=M(i.children)),s})}const re=o=>{const{components:i,classifications:s}=o,a=i.get(B),l=r=>{if(!r)return;const f=r;f.dataTransform={Actions:m=>m};const g=(m,S={})=>{const y=a.list,e=m[0],t=y[e],h=[];if(!e||!t)return h;for(const C in t){const x={...S,[e]:[C]},p=a.find(x);if(Object.keys(p).length>0){const c={filter:x};c.children=g(m.slice(1),x),h.push(c)}}return h},b=[];for(const m in s){const S=s[m],y=g(S),e=M(y);b.push({data:{System:m},children:e})}f.data=b};return w`
  <div>
    ${Object.keys(s).length===0?w`<bim-label label="No classifications to show"></bim-label>`:w`<bim-table ${R(l)} headers-hidden expanded></bim-table>`}
  </div>
  `},se=(o,i=!0)=>{const s=$.create(re,o);if(i){const{components:a}=o,l=a.get(V),[,r]=s;l.onFragmentsDisposed.add(()=>r())}return s},ce=Object.freeze(Object.defineProperty({__proto__:null,classificationTree:se},Symbol.toStringTag,{value:"Module"})),ae=o=>$.create(q,o),ue=Object.freeze(Object.defineProperty({__proto__:null,elementProperties:ae},Symbol.toStringTag,{value:"Module"})),le=(o,i=!0)=>{const s=$.create(K,o);if(i){const[,a]=s,{components:l}=o,r=l.get(V),f=l.get(_),g=()=>a({models:r.groups.values()});f.onRelationsIndexed.add(g),r.onFragmentsDisposed.add(g)}return s},de=Object.freeze(Object.defineProperty({__proto__:null,relationsTree:le},Symbol.toStringTag,{value:"Module"})),W=(o,i)=>[...o.get(Z).list.values()].find(l=>l.world===i),fe=(o,i)=>w`
    <bim-color-input @input=${a=>{const l=a.target;o.color=new L(l.color)}} color=${i}></bim-color-input>
  `,me=(o,i)=>{const{postproduction:s}=o,a=s.n8ao.configuration;return w`
    <bim-color-input @input=${r=>{const f=r.target;a.color=new L(f.color)}} color=${i}></bim-color-input>
  `},pe=(o,i)=>{const{color:s,opacity:a}=JSON.parse(i),{postproduction:l}=o,{customEffects:r}=l;return w`
    <bim-color-input @input=${g=>{const{color:b,opacity:m}=g.target;r.lineColor=new L(b).getHex(),m&&(r.opacity=m/100)}} color=${s} opacity=${a*100}></bim-color-input>
  `},ge=(o,i)=>w`
    <bim-color-input @input=${a=>{const l=a.target,r=new L(l.color);o.material.uniforms.uColor.value=r}} color=${i}></bim-color-input>
  `,he=(o,i)=>{const{postproduction:s}=o;return w`
    <bim-checkbox @change=${l=>{const r=l.target;s.setPasses({ao:r.checked})}} .checked=${i}></bim-checkbox>
  `},be=(o,i)=>{const{postproduction:s}=o;return w`
    <bim-checkbox @change=${l=>{const r=l.target;s.setPasses({gamma:r.checked})}} .checked=${i}></bim-checkbox>
  `},ye=(o,i)=>{const{postproduction:s}=o;return w`
    <bim-checkbox @change=${l=>{const r=l.target;s.setPasses({custom:r.checked})}} .checked=${i}></bim-checkbox>
  `},A=(o,i,s,a=()=>{})=>w`
    <bim-checkbox .checked="${s}" @change="${r=>{const g=r.target.checked;o[i]=g,a(g)}}"></bim-checkbox> 
  `,I=(o,i,s,a)=>{const l={slider:!1,min:0,max:100,step:1,prefix:null,suffix:null,onInputSet:()=>{},...a},{slider:r,min:f,max:g,step:b,suffix:m,prefix:S,onInputSet:y}=l;return w`
    <bim-number-input
      .pref=${S}
      .suffix=${m}
      .slider=${r} 
      min=${f} 
      value="${s}" 
      max=${g} 
      step=${b} 
      @change="${t=>{const C=t.target.value;o[i]=C,y(C)}}"
    ></bim-number-input> 
  `},Ce=o=>{const{components:i}=o,s=i.get(P);return w`<bim-table ${R(async l=>{var g,b,m,S,y;if(!l)return;const r=l;r.preserveStructureOnFilter=!0,r.dataTransform={Value:(e,t)=>{const h=t.World,C=s.list.get(h);if(!C)return e;const{scene:x,camera:p,renderer:n}=C,c=t.Name;if(c==="Grid"&&t.IsGridConfig&&typeof e=="boolean"){const u=W(i,C);return u?A(u,"visible",e):e}if(c==="Color"&&t.IsGridConfig&&typeof e=="string"){const u=W(i,C);return u?ge(u,e):e}if(c==="Distance"&&t.IsGridConfig&&typeof e=="number"){const u=W(i,C);return u?I(u.material.uniforms.uDistance,"value",e,{slider:!0,min:300,max:1e3}):e}if(c==="Size"&&t.IsGridConfig&&typeof e=="string"){const u=W(i,C);if(!u)return e;const{x:d,y:N}=JSON.parse(e),G=I(u.material.uniforms.uSize1,"value",d,{slider:!0,suffix:"m",prefix:"A",min:1,max:20}),k=I(u.material.uniforms.uSize2,"value",N,{slider:!0,suffix:"m",prefix:"B",min:1,max:20});return w`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${G}${k}</div>
          `}if(c==="Near Frustum"&&p.three instanceof T&&typeof e=="number"){const u=p.three;return I(p.three,"near",e,{slider:!0,min:.1,max:10,step:.1,onInputSet:()=>u.updateProjectionMatrix()})}if(c==="Far Frustum"&&p.three instanceof T&&typeof e=="number"){const u=p.three;return I(p.three,"far",e,{slider:!0,min:300,max:2e3,step:10,onInputSet:()=>u.updateProjectionMatrix()})}if(c==="Field of View"&&p.three instanceof T&&typeof e=="number"){const u=p.three;return I(p.three,"fov",e,{slider:!0,min:10,max:120,onInputSet:()=>u.updateProjectionMatrix()})}if(c==="Invert Drag"&&p.hasCameraControls()&&typeof e=="boolean")return A(p.controls,"dollyDragInverted",e);if(c==="Dolly Speed"&&p.hasCameraControls()&&typeof e=="number")return I(p.controls,"dollySpeed",e,{slider:!0,min:.5,max:3,step:.1});if(c==="Truck Speed"&&p.hasCameraControls()&&typeof e=="number")return I(p.controls,"truckSpeed",e,{slider:!0,min:.5,max:6,step:.1});if(c==="Smooth Time"&&p.hasCameraControls()&&typeof e=="number")return I(p.controls,"smoothTime",e,{slider:!0,min:.01,max:2,step:.01});if(c==="Intensity"&&typeof e=="number"){if(t.Light&&typeof t.Light=="string"){const u=x.three.children.find(d=>d.uuid===t.Light);return u&&u instanceof E?I(u,"intensity",e,{slider:!0,min:0,max:10,step:.1}):e}if(t.IsAOConfig&&n instanceof O)return I(n.postproduction.n8ao.configuration,"intensity",e,{slider:!0,max:16,step:.1})}if(c==="Color"&&typeof e=="string"){const u=t.Light,d=x.three.children.find(N=>N.uuid===u);if(d&&d instanceof E)return fe(d,e);if(t.IsAOConfig&&n instanceof O)return me(n,e)}if(c==="Ambient Oclussion"&&typeof e=="boolean"&&t.IsAOConfig&&n instanceof O)return he(n,e);if(c==="Half Resolution"&&t.IsAOConfig&&n instanceof O&&typeof e=="boolean")return A(n.postproduction.n8ao.configuration,"halfRes",e);if(c==="Screen Space Radius"&&t.IsAOConfig&&n instanceof O&&typeof e=="boolean")return A(n.postproduction.n8ao.configuration,"screenSpaceRadius",e);if(c==="Radius"&&t.IsAOConfig&&n instanceof O&&typeof e=="number")return I(n.postproduction.n8ao.configuration,"aoRadius",e,{slider:!0,max:2,step:.1});if(c==="Denoise Samples"&&t.IsAOConfig&&n instanceof O&&typeof e=="number")return I(n.postproduction.n8ao.configuration,"denoiseSamples",e,{slider:!0,min:1,max:16});if(c==="Samples"&&t.IsAOConfig&&n instanceof O&&typeof e=="number")return I(n.postproduction.n8ao.configuration,"aoSamples",e,{slider:!0,min:1,max:16});if(c==="Denoise Radius"&&t.IsAOConfig&&n instanceof O&&typeof e=="number")return I(n.postproduction.n8ao.configuration,"denoiseRadius",e,{slider:!0,min:0,max:16,step:.1});if(c==="Distance Falloff"&&t.IsAOConfig&&n instanceof O&&typeof e=="number")return I(n.postproduction.n8ao.configuration,"distanceFalloff",e,{slider:!0,min:0,max:4,step:.1});if(c==="Directional Light"&&t.Light&&typeof t.Light=="string"&&typeof e=="boolean"){const u=x.three.children.find(d=>d.uuid===t.Light);return u&&u instanceof E?A(u,"visible",e):e}if(c==="Ambient Light"&&t.Light&&typeof t.Light=="string"&&typeof e=="boolean"){const u=x.three.children.find(d=>d.uuid===t.Light);return u&&u instanceof E?A(u,"visible",e):e}if(c==="Position"&&t.Light&&typeof t.Light=="string"&&typeof e=="string"){const u=x.three.children.find(H=>H.uuid===t.Light);if(!(u&&u instanceof E))return e;const{x:d,y:N,z:G}=JSON.parse(e),k=I(u.position,"x",d,{slider:!0,prefix:"X",suffix:"m",min:-50,max:50}),F=I(u.position,"y",N,{slider:!0,prefix:"Y",suffix:"m",min:-50,max:50}),z=I(u.position,"z",G,{slider:!0,prefix:"Z",suffix:"m",min:-50,max:50});return w`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${k}${F}${z}</div>
          `}return c==="Custom Effects"&&t.IsCEConfig&&n instanceof O&&typeof e=="boolean"?ye(n,e):c==="Color"&&t.IsOutlineConfig&&n instanceof O&&typeof e=="string"?pe(n,e):c==="Tolerance"&&t.IsOutlineConfig&&n instanceof O&&typeof e=="number"?I(n.postproduction.customEffects,"tolerance",e,{slider:!0,min:0,max:6,step:.01}):c==="Outline"&&t.IsOutlineConfig&&n instanceof O&&typeof e=="boolean"?A(n.postproduction.customEffects,"outlineEnabled",e):c==="Gloss"&&t.IsGlossConfig&&n instanceof O&&typeof e=="boolean"?A(n.postproduction.customEffects,"glossEnabled",e):c==="Min"&&t.IsGlossConfig&&n instanceof O&&typeof e=="number"?I(n.postproduction.customEffects,"minGloss",e,{slider:!0,min:-.5,max:.5,step:.01}):c==="Max"&&t.IsGlossConfig&&n instanceof O&&typeof e=="number"?I(n.postproduction.customEffects,"maxGloss",e,{slider:!0,min:-.5,max:.5,step:.01}):c==="Exponent"&&t.IsGlossConfig&&n instanceof O&&typeof e=="number"?I(n.postproduction.customEffects,"glossExponent",e,{slider:!0,min:0,max:5,step:.01}):c==="Gamma Correction"&&t.IsGammaConfig&&n instanceof O&&typeof e=="boolean"?be(n,e):e}},r.addEventListener("cellcreated",({detail:e})=>{const t=e.cell.parentNode;if(!t)return;const h=t.querySelector("bim-table-cell[column='Name']"),C=t.querySelector("bim-table-cell[column='Value']");h&&!C&&(h.style.gridColumn="1 / -1")});const f=[];for(const[,e]of s.list){const{scene:t,camera:h,renderer:C}=e,x=W(i,e),p={data:{Name:e instanceof Q&&e.name||e.uuid},children:[]};if(t){const n={data:{Name:"Scene"}};if(x){const d={data:{Name:"Grid",Value:x.three.visible,World:e.uuid,IsGridConfig:!0},children:[{data:{Name:"Color",get Value(){return`#${x.material.uniforms.uColor.value.getHexString()}`},World:e.uuid,IsGridConfig:!0}},{data:{Name:"Size",get Value(){const N=x.material.uniforms.uSize1.value,G=x.material.uniforms.uSize2.value;return JSON.stringify({x:N,y:G})},World:e.uuid,IsGridConfig:!0}},{data:{Name:"Distance",Value:x.material.uniforms.uDistance.value,World:e.uuid,IsGridConfig:!0}}]};n.children||(n.children=[]),n.children.push(d)}const c=t.three.children.filter(d=>d instanceof X);for(const d of c){const N={data:{Name:"Directional Light",Value:d.visible,World:e.uuid,Light:d.uuid},children:[{data:{Name:"Position",Value:JSON.stringify(d.position),World:e.uuid,Light:d.uuid}},{data:{Name:"Intensity",Value:d.intensity,World:e.uuid,Light:d.uuid}},{data:{Name:"Color",Value:`#${d.color.getHexString()}`,World:e.uuid,Light:d.uuid}}]};n.children||(n.children=[]),n.children.push(N)}const u=t.three.children.filter(d=>d instanceof Y);for(const d of u){const N={data:{Name:"Ambient Light",Value:d.visible,World:e.uuid,Light:d.uuid},children:[{data:{Name:"Intensity",Value:d.intensity,World:e.uuid,Light:d.uuid}},{data:{Name:"Color",Value:`#${d.color.getHexString()}`,World:e.uuid,Light:d.uuid}}]};n.children||(n.children=[]),n.children.push(N)}n.children&&((g=n.children)==null?void 0:g.length)>0&&((b=p.children)==null||b.push(n))}if(h.three instanceof T){const n={data:{Name:"Perspective Camera"},children:[{data:{Name:"Near Frustum",Value:h.three.near,World:e.uuid}},{data:{Name:"Far Frustum",Value:h.three.far,World:e.uuid}},{data:{Name:"Field of View",Value:h.three.fov,World:e.uuid}}]};if(h.hasCameraControls()){const{controls:c}=h,u={dollyDragInverted:"Invert Drag",dollySpeed:"Dolly Speed",truckSpeed:"Truck Speed",smoothTime:"Smooth Time"};for(const d in u){const N=c[d];N!=null&&((m=n.children)==null||m.push({data:{Name:u[d],Value:N,World:e.uuid}}))}}(S=p.children)==null||S.push(n)}if(C instanceof O){const{postproduction:n}=C,c=n.n8ao.configuration,u={data:{Name:"Renderer"},children:[{data:{Name:"Gamma Correction",Value:n.settings.gamma??!1,World:e.uuid,IsGammaConfig:!0}},{data:{Name:"Ambient Oclussion",Value:n.settings.ao??!1,World:e.uuid,IsAOConfig:!0},children:[{data:{Name:"Samples",Value:c.aoSamples,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Color",Value:`#${c.color.getHexString()}`,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Half Resolution",Value:c.halfRes,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Screen Space Radius",Value:c.screenSpaceRadius,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Radius",Value:c.aoRadius,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Intensity",Value:c.intensity,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Distance Falloff",Value:c.distanceFalloff,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Samples",Value:c.denoiseSamples,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Radius",Value:c.denoiseRadius,World:e.uuid,IsAOConfig:!0}}]},{data:{Name:"Custom Effects",Value:n.settings.custom??!1,World:e.uuid,IsCEConfig:!0},children:[{data:{Name:"Gloss",Value:n.customEffects.glossEnabled,World:e.uuid,IsGlossConfig:!0},children:[{data:{Name:"Min",Value:n.customEffects.minGloss,World:e.uuid,IsGlossConfig:!0}},{data:{Name:"Max",Value:n.customEffects.maxGloss,World:e.uuid,IsGlossConfig:!0}},{data:{Name:"Exponent",Value:n.customEffects.glossExponent,World:e.uuid,IsGlossConfig:!0}}]},{data:{Name:"Outline",Value:n.customEffects.outlineEnabled,World:e.uuid,IsOutlineConfig:!0},children:[{data:{Name:"Color",get Value(){const d=new L(n.customEffects.lineColor),N=n.customEffects.opacity;return JSON.stringify({color:`#${d.getHexString()}`,opacity:N})},World:e.uuid,IsOutlineConfig:!0}},{data:{Name:"Tolerance",Value:n.customEffects.tolerance,World:e.uuid,IsOutlineConfig:!0}}]}]}]};(y=p.children)==null||y.push(u)}f.push(p)}r.columns=[{name:"Name",width:"11rem"}],r.hiddenColumns=["World","Light","IsAOConfig","IsCEConfig","IsGlossConfig","IsOutlineConfig","IsGammaConfig","IsGridConfig"],r.data=f})} headers-hidden expanded></bim-table>`},Ie=(o,i=!0)=>{const s=$.create(Ce,o);if(i){const[a]=s,l=()=>s[1](),{components:r}=o,f=r.get(P);f.onDisposed.add(a.remove);for(const[,g]of f.list)g.onDisposed.add(l);a.addEventListener("disconnected",()=>{f.onDisposed.remove(a.remove);for(const[,g]of f.list)g.onDisposed.remove(l)})}return s},xe=Object.freeze(Object.defineProperty({__proto__:null,worldsConfiguration:Ie},Symbol.toStringTag,{value:"Module"})),Oe={...ee,...oe,...ce,...ue,...de,...xe};export{Oe as t};
