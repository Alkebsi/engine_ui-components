import{m as w,H as j,Q as le,z as M,_ as V,k as K,u as ue,x as T,i as Q,j as de,l as Z,p as X,r as ee,s as fe,I as te,t as ne,R as me,w as pe,y as ge,A as he,D as be,o as ye,E as Ce,h as oe,P as z,K as F,$ as A,S as Ie,U as we,W as Ne,C as H,b as xe,Y as Ee,Z as Re}from"./template-BPcC4_4Q.js";const Ae={"jhon.doe@example.com":{name:"Jhon Doe",picture:"https://www.profilebakery.com/wp-content/uploads/2023/04/Profile-Image-AI.jpg"}},Se=(t,n)=>{const s=(n??Ae)[t],c=(s==null?void 0:s.name)??t,o=c.trim().split(/\s+/);let i,l;return o[0]&&o[0][0]&&(i=o[0][0].toUpperCase(),o[0][1]&&(l=o[0][1].toUpperCase())),o[1]&&o[1][0]&&(l=o[1][0].toUpperCase()),w`
  <div style="display: flex; gap: 0.25rem; overflow: hidden;">
    ${!(s!=null&&s.picture)&&(i||l)?w`
      <bim-label
        style=${le({borderRadius:"999px",padding:"0.375rem",backgroundColor:"var(--bim-ui_bg-contrast-20)",aspectRatio:"1",fontSize:"0.7rem"})}>${i}${l}</bim-label>
      `:null}
    <bim-label .img=${s==null?void 0:s.picture}>${c}</bim-label>
  </div>
`},Te=t=>{const{topic:n,styles:r,viewpoint:s,actions:c}=t,o={delete:!0,...c};return w`<bim-table @cellcreated=${({detail:l})=>{const{cell:a}=l;a.style.marginLeft="0"}} ${j(l=>{if(!l)return;const a=l;a.headersHidden=!0,a.hiddenColumns=["guid","author"],a.dataTransform={Comment:(p,g)=>{const{guid:m}=g;if(typeof m!="string")return p;const e=n.comments.get(m);if(!e)return p;const d=()=>{n.comments.delete(m)};return w`
        <div style="display: flex; flex-direction: column; gap: 0.25rem; flex: 1">
          <div style="display: flex; justify-content: space-between;">
            <div style="display: flex; gap: 0.375rem;">
              ${Se(e.author,r)}
              <bim-label style="color: var(--bim-ui_bg-contrast-40)">@ ${e.date.toDateString()}</bim-label>
            </div>
            <div>
              <style>
                #TCDBT {
                  background-color: transparent;
                  --bim-label--c: var(--bim-ui_bg-contrast-60)
                }

                #TCDBT:hover {
                  --bim-label--c: #FF5252;
                }
              </style>
              ${o!=null&&o.delete?w`<bim-button @click=${d} id="TCDBT" icon="majesticons:delete-bin"></bim-button>`:null}
            </div>
          </div>
          <bim-label style="margin-left: 1.7rem; white-space: normal">${e.comment}</bim-label>
        </div>
      `}};let u=n.comments.values();s&&(u=[...n.comments.values()].filter(p=>p.viewpoint===s)),a.data=[...u].map(p=>({data:{guid:p.guid,Comment:p.comment,author:(()=>{const g=r;if(!g)return p.author;const m=g[p.author];return(m==null?void 0:m.name)??p.author})()}}))})}><bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">This topic has no comments</bim-label></bim-table>`},De=(t,n=!0)=>{const r=M.create(Te,t);if(n){const{topic:s}=t,[c,o]=r;s.comments.onItemSet.add(()=>o()),s.comments.onItemUpdated.add(()=>o()),s.comments.onItemDeleted.add(()=>o()),s.comments.onCleared.add(()=>o())}return r},$e=Object.freeze(Object.defineProperty({__proto__:null,topicComments:De},Symbol.toStringTag,{value:"Module"})),Oe=t=>{const{components:n,actions:r,tags:s}=t,c=(r==null?void 0:r.dispose)??!0,o=(r==null?void 0:r.download)??!0,i=(r==null?void 0:r.visibility)??!0,l=(s==null?void 0:s.schema)??!0,a=(s==null?void 0:s.viewDefinition)??!0,u=n.get(V),p=({detail:m})=>{const{cell:e}=m;e.style.padding="0.25rem 0"};return w`
    <bim-table ${j(m=>{if(!m)return;const e=m;e.hiddenColumns=["modelID"];const d=[];for(const[,h]of u.groups){if(!h)continue;const x={data:{Name:h.name||h.uuid,modelID:h.uuid}};d.push(x)}e.dataTransform={Name:(h,x)=>{const{modelID:N}=x;if(typeof N!="string")return h;const I=u.groups.get(N);if(!I)return N;const f={};for(const D of I.items)f[D.id]=D.ids;let b;const{schema:y}=I.ifcMetadata;l&&y&&(b=w`
            <bim-label style="background-color: var(--bim-ui_main-base); padding: 0 0.25rem; color: var(--bim-ui_main-contrast); border-radius: 0.25rem;">${y}</bim-label>
            `);let C;if(a&&"viewDefinition"in I.ifcMetadata){const D=I.ifcMetadata.viewDefinition;C=w`
            ${D.split(",").map(S=>w`<bim-label style="background-color: var(--bim-ui_main-base); padding: 0 0.25rem; color: var(--bim-ui_main-contrast); border-radius: 0.25rem;">${S}</bim-label>`)}
          `}let R;c&&(R=w`<bim-button @click=${()=>u.disposeGroup(I)} icon="mdi:delete"></bim-button>`);let O;i&&(O=w`<bim-button @click=${S=>{const P=n.get(K),G=S.target;P.set(G.hasAttribute("data-model-hidden"),f),G.toggleAttribute("data-model-hidden"),G.icon=G.hasAttribute("data-model-hidden")?"mdi:eye-off":"mdi:eye"}} icon="mdi:eye"></bim-button>`);let v;return o&&(v=w`<bim-button @click=${()=>{const S=document.createElement("input");S.type="file",S.accept=".ifc",S.multiple=!1,S.addEventListener("change",async()=>{if(!(S.files&&S.files.length===1))return;const P=S.files[0],G=await P.arrayBuffer(),ce=await n.get(ue).saveToIfc(I,new Uint8Array(G)),q=new File([ce],P.name),U=document.createElement("a");U.href=URL.createObjectURL(q),U.download=q.name,U.click(),URL.revokeObjectURL(U.href)}),S.click()}} icon="flowbite:download-solid"></bim-button>`),w`
         <div style="display: flex; flex: 1; gap: var(--bim-ui_size-4xs); justify-content: space-between; overflow: auto;">
          <div style="display: flex; flex-wrap: wrap; align-items: center; gap: 0 var(--bim-ui_size-4xs); flex-grow: 1; overflow: auto;">
            <div style="min-height: 1.75rem; overflow: auto; display: flex;">
              <bim-label style="white-space: normal;">${h}</bim-label>
            </div>
            <div style="display: flex; flex-wrap: wrap; gap: var(--bim-ui_size-4xs); overflow: auto;">
              ${b}
              ${C}
            </div>
          </div>
          <div style="display: flex; align-self: flex-start; flex-shrink: 0;">
            ${v}
            ${O}
            ${R}
          </div>
         </div>
        `}},e.data=d})} @cellcreated=${p} headers-hidden no-indentation>
      <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
        No models has been loaded yet
      </bim-label>
    </bim-table>
  `},ve=(t,n=!0)=>{const r=M.create(Oe,t);if(n){const{components:s}=t,c=s.get(V),[,o]=r;c.onFragmentsLoaded.add(()=>setTimeout(()=>o())),c.onFragmentsDisposed.add(()=>o())}return r},Le=Object.freeze(Object.defineProperty({__proto__:null,modelsList:ve},Symbol.toStringTag,{value:"Module"})),ie=["Name","ContainedInStructure","ForLayerSet","LayerThickness","HasProperties","HasAssociations","HasAssignments","HasPropertySets","PredefinedType","Quantities","ReferencedSource","Identification",t=>t.includes("Value"),t=>t.startsWith("Material"),t=>t.startsWith("Relating"),t=>{const n=["IsGroupedBy","IsDecomposedBy"];return t.startsWith("Is")&&!n.includes(t)}];async function J(t,n,r,s=ie,c=!1){const o=t.get(T),i=await n.getProperties(r);if(!i)return{data:{Entity:`${r} properties not found...`}};const l=o.relationMaps[n.uuid],a={data:{}};for(const u in i){const p=s.map(m=>typeof m=="string"?u===m:m(u)).includes(!0);if(!(u==="type"||p))continue;const g=i[u];if(g)if(g.type===5){a.children||(a.children=[]);const m=await J(t,n,g.value,s,c);a.children.push(m)}else if(typeof g=="object"&&!Array.isArray(g)){const{value:m,type:e}=g;if(c)e===1||e===2||e===3||(a.data[u]=m);else{const d=typeof m=="number"?Number(m.toFixed(3)):m;a.data[u]=d}}else if(Array.isArray(g))for(const m of g){if(m.type!==5)continue;a.children||(a.children=[]);const e=await J(t,n,m.value,s,c);a.children.push(e)}else if(u==="type"){const m=Q[g];a.data.Entity=m}else a.data[u]=g}if(l&&l.get(i.expressID)){const u=l.get(i.expressID);for(const p of s){const g=[];if(typeof p=="string"){const m=o._inverseAttributes.indexOf(p);m!==-1&&g.push(m)}else{const m=o._inverseAttributes.filter(e=>p(e));for(const e of m){const d=o._inverseAttributes.indexOf(e);g.push(d)}}for(const m of g){const e=u.get(m);if(e)for(const d of e){const h=await J(t,n,d,s,c);a.children||(a.children=[]),a.children.push(h)}}}}return a}const ke=t=>{const{components:n,fragmentIdMap:r,attributesToInclude:s,editable:c,tableDefinition:o}=t,i=n.get(V);let l;return typeof s=="function"?l=s(ie):l=s,w`<bim-table ${j(async u=>{if(!u)return;const p=u,g=[],m=[];for(const e in r){const d=i.list.get(e);if(!(d&&d.group))continue;const h=d.group,x=m.find(N=>N.model===h);if(x)for(const N of r[e])x.expressIDs.add(N);else{const N={model:h,expressIDs:new Set(r[e])};m.push(N)}}for(const e of m){const{model:d,expressIDs:h}=e;for(const x of h){const N=await J(n,d,x,l,c);g.push(N)}}p.dataTransform=o,p.data=g,p.columns=[{name:"Entity",width:"minmax(15rem, 1fr)"}]})}></bim-table>`},Me=t=>M.create(ke,t),Ve=Object.freeze(Object.defineProperty({__proto__:null,entityAttributes:Me},Symbol.toStringTag,{value:"Module"}));let L;const Pe=t=>{const{components:n,classifications:r}=t,s=n.get(de),c=n.get(K);L||(L=document.createElement("bim-table"),L.headersHidden=!0,L.hiddenColumns=["system"],L.columns=["Name",{name:"Actions",width:"auto"}],L.dataTransform={Actions:(i,l)=>{const{system:a,Name:u}=l;if(!(typeof a=="string"&&typeof u=="string"))return i;const p=s.list[a];if(!(p&&p[u]))return i;const g=p[u],{map:m}=g;return w`
          <div>
            <bim-checkbox checked @change=${d=>{const h=d.target;c.set(h.value,m)}}></bim-checkbox>
          </div>
        `}});const o=[];for(const i of r){const l=typeof i=="string"?i:i.system,a=typeof i=="string"?i:i.label,u=s.list[l];u&&o.push({data:{Name:a,system:l},children:Object.keys(u).map(p=>({data:{Name:p,system:l,Actions:""}}))})}return L.data=o,w`${L}`},Ge=(t,n=!0)=>{const r=M.create(Pe,t);if(n){const{components:s}=t,c=s.get(V),[,o]=r;c.onFragmentsDisposed.add(()=>o())}return r},_e=Object.freeze(Object.defineProperty({__proto__:null,classificationTree:Ge},Symbol.toStringTag,{value:"Module"})),se=async(t,n,r)=>{var l,a,u,p;const s=t.get(T),c={data:{Name:(l=r.Name)==null?void 0:l.value},children:[{data:{Name:"Identification",Value:(a=r.Identification)==null?void 0:a.value}},{data:{Name:"Name",Value:(u=r.Name)==null?void 0:u.value}},{data:{Name:"Description",Value:(p=r.Description)==null?void 0:p.value}}]},o=s.getEntityRelations(n,r.expressID,"IsNestedBy");if(!o)return c;c.children||(c.children=[]);const i=[];c.children.push({data:{Name:"Tasks"},children:i});for(const g of o){const m=await n.getProperties(g);if(!m)continue;const e=await se(t,n,m);i.push(e)}return c},Fe=async(t,n,r)=>{const s=[];for(const o of r){const i=await se(t,n,o);s.push(i)}return{data:{Name:"Tasks"},children:s}},We=async(t,n)=>{var s,c;const r={data:{Name:"Classifications"}};for(const o of n){const{value:i}=o.ReferencedSource,l=await t.getProperties(i);if(!l)continue;const a={data:{Name:l.Name.value},children:[{data:{Name:"Identification",Value:((s=o.Identification)==null?void 0:s.value)||((c=o.ItemReference)==null?void 0:c.value)}},{data:{Name:"Name",Value:o.Name.value}}]};r.children||(r.children=[]),r.children.push(a)}return r},je=async(t,n)=>{const r={data:{Name:"Materials"}};for(const s of n){if(s.type===Z){const c=s.ForLayerSet.value,o=await t.getProperties(c);if(!o)continue;for(const i of o.MaterialLayers){const{value:l}=i,a=await t.getProperties(l);if(!a)continue;const u=await t.getProperties(a.Material.value);if(!u)continue;const p={data:{Name:"Layer"},children:[{data:{Name:"Thickness",Value:a.LayerThickness.value}},{data:{Name:"Material",Value:u.Name.value}}]};r.children||(r.children=[]),r.children.push(p)}}if(s.type===X)for(const c of s.Materials){const{value:o}=c,i=await t.getProperties(o);if(!i)continue;const l={data:{Name:"Name",Value:i.Name.value}};r.children||(r.children=[]),r.children.push(l)}if(s.type===ee){const c={data:{Name:"Name",Value:s.Name.value}};r.children||(r.children=[]),r.children.push(c)}}return r},He={IFCLENGTHMEASURE:"LENGTHUNIT",IFCAREAMEASURE:"AREAUNIT",IFCVOLUMEMEASURE:"VOLUMEUNIT",IFCPLANEANGLEMEASURE:"PLANEANGLEUNIT"},Ue={MILLIMETRE:{symbol:"mm",digits:0},METRE:{symbol:"m",digits:2},KILOMETRE:{symbol:"km",digits:2},SQUARE_METRE:{symbol:"m²",digits:2},CUBIC_METRE:{symbol:"m³",digits:2},DEGREE:{symbol:"°",digits:2},RADIAN:{symbol:"rad",digits:2},GRAM:{symbol:"g",digits:0},KILOGRAM:{symbol:"kg",digits:2},MILLISECOND:{symbol:"ms",digits:0},SECOND:{symbol:"s",digits:0}},re=async(t,n)=>{var c,o,i;const r=Object.values(await t.getAllPropertiesOfType(fe))[0];let s;for(const l of r.Units){const a=await t.getProperties(l.value);if(a&&((c=a.UnitType)==null?void 0:c.value)===He[n]){s=`${((o=a.Prefix)==null?void 0:o.value)??""}${((i=a.Name)==null?void 0:i.value)??""}`;break}}return s?Ue[s]:null},ze=async(t,n,r)=>{const{displayUnits:s}=r,c={data:{Name:"PropertySets"}};for(const o of n){const i={data:{Name:o.Name.value}};if(o.type===te){for(const l of o.HasProperties){const{value:a}=l,u=await t.getProperties(a);if(!u)continue;const p=Object.keys(u).find(d=>d.includes("Value"));if(!(p&&u[p]))continue;let g=u[p].value,m="";if(s){const{name:d}=u[p],h=await re(t,d)??{};m=h.symbol,g=u[p].value,typeof g=="number"&&h.digits&&(g=g.toFixed(h.digits))}const e={data:{Name:u.Name.value,Value:`${g} ${m??""}`}};i.children||(i.children=[]),i.children.push(e)}i.children&&(c.children||(c.children=[]),c.children.push(i))}}return c},Be=async(t,n,r)=>{const{displayUnits:s}=r,c={data:{Name:"QuantitySets"}};for(const o of n){const i={data:{Name:o.Name.value}};if(o.type===ne){for(const l of o.Quantities){const{value:a}=l,u=await t.getProperties(a);if(!u)continue;const p=Object.keys(u).find(d=>d.includes("Value"));if(!(p&&u[p]))continue;let g=u[p].value,m="";if(s){const{name:d}=u[p],h=await re(t,d)??{};m=h.symbol,g=u[p].value,typeof g=="number"&&h.digits&&(g=g.toFixed(h.digits))}const e={data:{Name:u.Name.value,Value:`${g} ${m??""}`}};i.children||(i.children=[]),i.children.push(e)}i.children&&(c.children||(c.children=[]),c.children.push(i))}}return c},Je=["OwnerHistory","ObjectPlacement","CompositionType"],ae=async(t,n)=>{const s={...{groupName:"Attributes",includeClass:!1},...n},{groupName:c,includeClass:o}=s,i={data:{Name:c}};o&&(i.children||(i.children=[]),i.children.push({data:{Name:"Class",Value:Q[t.type]}}));for(const l in t){if(Je.includes(l))continue;const a=t[l];if(a&&typeof a=="object"&&!Array.isArray(a)){if(a.type===me)continue;const u={data:{Name:l,Value:a.value}};i.children||(i.children=[]),i.children.push(u)}}return i},_=(t,...n)=>{t.children||(t.children=[]),t.children.push(...n)},Qe=async(t,n,r,s,c)=>{const i=t.get(T).getEntityRelations(n,r,"IsDefinedBy");if(i){const l=[],a=[];for(const g of i){const m=await n.getProperties(g);m&&(m.type===te&&l.push(m),m.type===ne&&a.push(m))}const u=await ze(n,l,c);u.children&&_(s,u);const p=await Be(n,a,c);p.children&&_(s,p)}},Ye=async(t,n,r,s)=>{const o=t.get(T).getEntityRelations(n,r,"HasAssociations");if(o){const i=[],l=[];for(const p of o){const g=await n.getProperties(p);g&&(g.type===pe&&i.push(g),(g.type===Z||g.type===ge||g.type===he||g.type===ee||g.type===X)&&l.push(g))}const a=await We(n,i);a.children&&_(s,a);const u=await je(n,l);u.children&&_(s,u)}},qe=async(t,n,r,s)=>{const o=t.get(T).getEntityRelations(n,r,"HasAssignments");if(o){const i=[];for(const a of o){const u=await n.getProperties(a);u&&u.type===be&&i.push(u)}const l=await Fe(t,n,i);l.children&&_(s,l)}},Ke=async(t,n,r,s)=>{const o=t.get(T).getEntityRelations(n,r,"ContainedInStructure");if(o&&o[0]){const i=o[0],l=await n.getProperties(i);if(l){const a=await ae(l,{groupName:"SpatialContainer"});_(s,a)}}};let B={};const Ze=async(t,n,r)=>{var l;const s=t.get(T),c=t.get(V),o=c.getModelIdMap(n);Object.keys(n).length===0&&(B={});const i=[];for(const a in o){const u=c.groups.get(a);if(!u)continue;const p=s.relationMaps[u.uuid];if(!p)continue;a in B||(B[a]=new Map);const g=B[a],m=o[a];for(const e of m){let d=g.get(e);if(d){i.push(d);continue}const h=await u.getProperties(e);if(!h)continue;d={data:{Name:(l=h.Name)==null?void 0:l.value}},i.push(d),g.set(e,d);const x=await ae(h,{includeClass:!0});d.children||(d.children=[]),d.children.push(x),p.get(e)&&(await Qe(t,u,e,d,r),await Ye(t,u,e,d),await qe(t,u,e,d),await Ke(t,u,e,d))}}return i},Xe=t=>{const n={emptySelectionWarning:!0,...t},{components:r,fragmentIdMap:s,emptySelectionWarning:c}=n;return w`
    <bim-table @cellcreated=${({detail:l})=>{const{cell:a}=l;a.column==="Name"&&!("Value"in a.rowData)&&(a.style.gridColumn="1 / -1")}} ${j(async l=>{if(!l)return;const a=l;a.columns=[{name:"Name",width:"12rem"}],a.headersHidden=!0,a.loadFunction=()=>Ze(r,s,t),await a.loadData(!0)&&a.dispatchEvent(new Event("datacomputed"))})}>
      ${c?w`
            <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
              Select some elements to display its properties
            </bim-label>
          `:null}
    </bim-table>
  `},et=t=>M.create(Xe,t),tt=Object.freeze(Object.defineProperty({__proto__:null,elementProperties:et},Symbol.toStringTag,{value:"Module"})),Y=async(t,n,r,s)=>{var u;const c=[],o=t.get(T),i=await n.getProperties(r);if(!i)return c;const{type:l}=i,a={data:{Entity:Q[l],Name:(u=i.Name)==null?void 0:u.value,modelID:n.uuid,expressID:r}};for(const p of s){const g=o.getEntityRelations(n,r,p);if(!g)continue;a.children||(a.children=[]),a.data.relations=JSON.stringify(g);const m={};for(const e of g){const d=await Y(t,n,e,s);for(const h of d)if(h.data.relations)a.children.push(h);else{const x=n.data.get(e);if(!x){a.children.push(h);continue}const N=x[1][1],I=Q[N];I in m||(m[I]=[]),h.data.Entity=h.data.Name,delete h.data.Name,m[I].push(h)}}for(const e in m){const d=m[e],h=d.map(N=>N.data.expressID),x={data:{Entity:e,modelID:n.uuid,relations:JSON.stringify(h)},children:d};a.children.push(x)}}return c.push(a),c},nt=async(t,n,r,s)=>{const c=t.get(T),o=[];for(const i of n){let l;if(s)l={data:{Entity:i.name!==""?i.name:i.uuid},children:await Y(t,i,s,r)};else{const a=c.relationMaps[i.uuid],u=await i.getAllPropertiesOfType(Ce);if(!(a&&u))continue;const{expressID:p}=Object.values(u)[0];l={data:{Entity:i.name!==""?i.name:i.uuid},children:await Y(t,i,p,r)}}o.push(l)}return o};let $;const ot=(t,n)=>{const r=t.get(V),{modelID:s,expressID:c,relations:o}=n.data;if(!s)return null;const i=r.groups.get(s);return i?i.getFragmentMap([c,...JSON.parse(o??"[]")]):null},it=t=>{const{components:n,models:r,expressID:s}=t,c=t.selectHighlighterName??"select",o=t.hoverHighlighterName??"hover";$||($=document.createElement("bim-table"),$.hiddenColumns=["modelID","expressID","relations"],$.columns=["Entity","Name"],$.headersHidden=!0,$.addEventListener("cellcreated",({detail:l})=>{const{cell:a}=l;a.column==="Entity"&&!("Name"in a.rowData)&&(a.style.gridColumn="1 / -1")})),$.addEventListener("rowcreated",l=>{l.stopImmediatePropagation();const{row:a}=l.detail,u=n.get(ye),p=ot(n,a);p&&Object.keys(p).length!==0&&(a.onmouseover=()=>{o&&(a.style.backgroundColor="var(--bim-ui_bg-contrast-20)",u.highlightByID(o,p,!0,!1,u.selection[c]??{}))},a.onmouseout=()=>{a.style.backgroundColor="",u.clear(o)},a.onclick=()=>{c&&u.highlightByID(c,p,!0,!0)})});const i=t.inverseAttributes??["IsDecomposedBy","ContainsElements"];return nt(n,r,i,s).then(l=>$.data=l),w`${$}`},st=(t,n=!0)=>{const r=M.create(it,t);if(n){const[,s]=r,{components:c}=t,o=c.get(V),i=c.get(T),l=()=>s({models:o.groups.values()});i.onRelationsIndexed.add(l),o.onFragmentsDisposed.add(l)}return r},rt=Object.freeze(Object.defineProperty({__proto__:null,relationsTree:st},Symbol.toStringTag,{value:"Module"})),W=(t,n)=>[...t.get(xe).list.values()].find(c=>c.world===n),at=(t,n)=>w`
    <bim-color-input @input=${s=>{const c=s.target;t.color=new H(c.color)}} color=${n}></bim-color-input>
  `,ct=(t,n)=>{const{postproduction:r}=t,s=r.n8ao.configuration;return w`
    <bim-color-input @input=${o=>{const i=o.target;s.color=new H(i.color)}} color=${n}></bim-color-input>
  `},lt=(t,n)=>{const{color:r,opacity:s}=JSON.parse(n),{postproduction:c}=t,{customEffects:o}=c;return w`
    <bim-color-input @input=${l=>{const{color:a,opacity:u}=l.target;o.lineColor=new H(a).getHex(),u&&(o.opacity=u/100)}} color=${r} opacity=${s*100}></bim-color-input>
  `},ut=(t,n)=>w`
    <bim-color-input @input=${s=>{const c=s.target,o=new H(c.color);t.material.uniforms.uColor.value=o}} color=${n}></bim-color-input>
  `,dt=(t,n)=>{const{postproduction:r}=t;return w`
    <bim-checkbox @change=${c=>{const o=c.target;r.setPasses({ao:o.checked})}} .checked=${n}></bim-checkbox>
  `},ft=(t,n)=>{const{postproduction:r}=t;return w`
    <bim-checkbox @change=${c=>{const o=c.target;r.setPasses({gamma:o.checked})}} .checked=${n}></bim-checkbox>
  `},mt=(t,n)=>{const{postproduction:r}=t;return w`
    <bim-checkbox @change=${c=>{const o=c.target;r.setPasses({custom:o.checked})}} .checked=${n}></bim-checkbox>
  `},k=(t,n,r,s=()=>{})=>w`
    <bim-checkbox .checked="${r}" @change="${o=>{const l=o.target.checked;t[n]=l,s(l)}}"></bim-checkbox> 
  `,E=(t,n,r,s)=>{const c={slider:!1,min:0,max:100,step:1,prefix:null,suffix:null,onInputSet:()=>{},...s},{slider:o,min:i,max:l,step:a,suffix:u,prefix:p,onInputSet:g}=c;return w`
    <bim-number-input
      .pref=${p}
      .suffix=${u}
      .slider=${o} 
      min=${i} 
      value="${r}" 
      max=${l} 
      step=${a} 
      @change="${e=>{const h=e.target.value;t[n]=h,g(h)}}"
    ></bim-number-input> 
  `},pt=t=>{const{components:n}=t,r=n.get(oe);return w`
    <bim-table @cellcreated=${({detail:o})=>{const i=o.cell.parentNode;if(!i)return;const l=i.querySelector("bim-table-cell[column='Name']"),a=i.querySelector("bim-table-cell[column='Value']");l&&!a&&(l.style.gridColumn="1 / -1")}} ${j(async o=>{var a,u,p,g,m;if(!o)return;const i=o;i.preserveStructureOnFilter=!0,i.dataTransform={Value:(e,d)=>{const h=d.World,x=r.list.get(h);if(!x)return e;const{scene:N,camera:I,renderer:f}=x,b=d.Name;if(b==="Grid"&&d.IsGridConfig&&typeof e=="boolean"){const y=W(n,x);return y?k(y,"visible",e):e}if(b==="Color"&&d.IsGridConfig&&typeof e=="string"){const y=W(n,x);return y?ut(y,e):e}if(b==="Distance"&&d.IsGridConfig&&typeof e=="number"){const y=W(n,x);return y?E(y.material.uniforms.uDistance,"value",e,{slider:!0,min:300,max:1e3}):e}if(b==="Size"&&d.IsGridConfig&&typeof e=="string"){const y=W(n,x);if(!y)return e;const{x:C,y:R}=JSON.parse(e),O=E(y.material.uniforms.uSize1,"value",C,{slider:!0,suffix:"m",prefix:"A",min:1,max:20}),v=E(y.material.uniforms.uSize2,"value",R,{slider:!0,suffix:"m",prefix:"B",min:1,max:20});return w`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${O}${v}</div>
          `}if(b==="Near Frustum"&&I.three instanceof z&&typeof e=="number"){const y=I.three;return E(I.three,"near",e,{slider:!0,min:.1,max:10,step:.1,onInputSet:()=>y.updateProjectionMatrix()})}if(b==="Far Frustum"&&I.three instanceof z&&typeof e=="number"){const y=I.three;return E(I.three,"far",e,{slider:!0,min:300,max:2e3,step:10,onInputSet:()=>y.updateProjectionMatrix()})}if(b==="Field of View"&&I.three instanceof z&&typeof e=="number"){const y=I.three;return E(I.three,"fov",e,{slider:!0,min:10,max:120,onInputSet:()=>y.updateProjectionMatrix()})}if(b==="Invert Drag"&&I.hasCameraControls()&&typeof e=="boolean")return k(I.controls,"dollyDragInverted",e);if(b==="Dolly Speed"&&I.hasCameraControls()&&typeof e=="number")return E(I.controls,"dollySpeed",e,{slider:!0,min:.5,max:3,step:.1});if(b==="Truck Speed"&&I.hasCameraControls()&&typeof e=="number")return E(I.controls,"truckSpeed",e,{slider:!0,min:.5,max:6,step:.1});if(b==="Smooth Time"&&I.hasCameraControls()&&typeof e=="number")return E(I.controls,"smoothTime",e,{slider:!0,min:.01,max:2,step:.01});if(b==="Intensity"&&typeof e=="number"){if(d.Light&&typeof d.Light=="string"){const y=N.three.children.find(C=>C.uuid===d.Light);return y&&y instanceof F?E(y,"intensity",e,{slider:!0,min:0,max:10,step:.1}):e}if(d.IsAOConfig&&f instanceof A)return E(f.postproduction.n8ao.configuration,"intensity",e,{slider:!0,max:16,step:.1})}if(b==="Color"&&typeof e=="string"){const y=d.Light,C=N.three.children.find(R=>R.uuid===y);if(C&&C instanceof F)return at(C,e);if(d.IsAOConfig&&f instanceof A)return ct(f,e)}if(b==="Ambient Oclussion"&&typeof e=="boolean"&&d.IsAOConfig&&f instanceof A)return dt(f,e);if(b==="Half Resolution"&&d.IsAOConfig&&f instanceof A&&typeof e=="boolean")return k(f.postproduction.n8ao.configuration,"halfRes",e);if(b==="Screen Space Radius"&&d.IsAOConfig&&f instanceof A&&typeof e=="boolean")return k(f.postproduction.n8ao.configuration,"screenSpaceRadius",e);if(b==="Radius"&&d.IsAOConfig&&f instanceof A&&typeof e=="number")return E(f.postproduction.n8ao.configuration,"aoRadius",e,{slider:!0,max:2,step:.1});if(b==="Denoise Samples"&&d.IsAOConfig&&f instanceof A&&typeof e=="number")return E(f.postproduction.n8ao.configuration,"denoiseSamples",e,{slider:!0,min:1,max:16});if(b==="Samples"&&d.IsAOConfig&&f instanceof A&&typeof e=="number")return E(f.postproduction.n8ao.configuration,"aoSamples",e,{slider:!0,min:1,max:16});if(b==="Denoise Radius"&&d.IsAOConfig&&f instanceof A&&typeof e=="number")return E(f.postproduction.n8ao.configuration,"denoiseRadius",e,{slider:!0,min:0,max:16,step:.1});if(b==="Distance Falloff"&&d.IsAOConfig&&f instanceof A&&typeof e=="number")return E(f.postproduction.n8ao.configuration,"distanceFalloff",e,{slider:!0,min:0,max:4,step:.1});if(b==="Directional Light"&&d.Light&&typeof d.Light=="string"&&typeof e=="boolean"){const y=N.three.children.find(C=>C.uuid===d.Light);return y&&y instanceof F?k(y,"visible",e):e}if(b==="Ambient Light"&&d.Light&&typeof d.Light=="string"&&typeof e=="boolean"){const y=N.three.children.find(C=>C.uuid===d.Light);return y&&y instanceof F?k(y,"visible",e):e}if(b==="Position"&&d.Light&&typeof d.Light=="string"&&typeof e=="string"){const y=N.three.children.find(P=>P.uuid===d.Light);if(!(y&&y instanceof F))return e;const{x:C,y:R,z:O}=JSON.parse(e),v=E(y.position,"x",C,{slider:!0,prefix:"X",suffix:"m",min:-50,max:50}),D=E(y.position,"y",R,{slider:!0,prefix:"Y",suffix:"m",min:-50,max:50}),S=E(y.position,"z",O,{slider:!0,prefix:"Z",suffix:"m",min:-50,max:50});return w`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${v}${D}${S}</div>
          `}return b==="Custom Effects"&&d.IsCEConfig&&f instanceof A&&typeof e=="boolean"?mt(f,e):b==="Color"&&d.IsOutlineConfig&&f instanceof A&&typeof e=="string"?lt(f,e):b==="Tolerance"&&d.IsOutlineConfig&&f instanceof A&&typeof e=="number"?E(f.postproduction.customEffects,"tolerance",e,{slider:!0,min:0,max:6,step:.01}):b==="Outline"&&d.IsOutlineConfig&&f instanceof A&&typeof e=="boolean"?k(f.postproduction.customEffects,"outlineEnabled",e):b==="Gloss"&&d.IsGlossConfig&&f instanceof A&&typeof e=="boolean"?k(f.postproduction.customEffects,"glossEnabled",e):b==="Min"&&d.IsGlossConfig&&f instanceof A&&typeof e=="number"?E(f.postproduction.customEffects,"minGloss",e,{slider:!0,min:-.5,max:.5,step:.01}):b==="Max"&&d.IsGlossConfig&&f instanceof A&&typeof e=="number"?E(f.postproduction.customEffects,"maxGloss",e,{slider:!0,min:-.5,max:.5,step:.01}):b==="Exponent"&&d.IsGlossConfig&&f instanceof A&&typeof e=="number"?E(f.postproduction.customEffects,"glossExponent",e,{slider:!0,min:0,max:5,step:.01}):b==="Gamma Correction"&&d.IsGammaConfig&&f instanceof A&&typeof e=="boolean"?ft(f,e):e}};const l=[];for(const[,e]of r.list){const{scene:d,camera:h,renderer:x}=e,N=W(n,e),I={data:{Name:e instanceof Ie&&e.name||e.uuid},children:[]};if(d){const f={data:{Name:"Scene"}};if(N){const R=`#${N.material.uniforms.uColor.value.getHexString()}`,O=JSON.stringify({x:N.material.uniforms.uSize1.value,y:N.material.uniforms.uSize2.value}),v={data:{Name:"Grid",Value:N.three.visible,World:e.uuid,IsGridConfig:!0},children:[{data:{Name:"Color",Value:R,World:e.uuid,IsGridConfig:!0}},{data:{Name:"Size",Value:O,World:e.uuid,IsGridConfig:!0}},{data:{Name:"Distance",Value:N.material.uniforms.uDistance.value,World:e.uuid,IsGridConfig:!0}}]};f.children||(f.children=[]),f.children.push(v)}const b=d.three.children.filter(C=>C instanceof we);for(const C of b){const R={data:{Name:"Directional Light",Value:C.visible,World:e.uuid,Light:C.uuid},children:[{data:{Name:"Position",Value:JSON.stringify(C.position),World:e.uuid,Light:C.uuid}},{data:{Name:"Intensity",Value:C.intensity,World:e.uuid,Light:C.uuid}},{data:{Name:"Color",Value:`#${C.color.getHexString()}`,World:e.uuid,Light:C.uuid}}]};f.children||(f.children=[]),f.children.push(R)}const y=d.three.children.filter(C=>C instanceof Ne);for(const C of y){const R={data:{Name:"Ambient Light",Value:C.visible,World:e.uuid,Light:C.uuid},children:[{data:{Name:"Intensity",Value:C.intensity,World:e.uuid,Light:C.uuid}},{data:{Name:"Color",Value:`#${C.color.getHexString()}`,World:e.uuid,Light:C.uuid}}]};f.children||(f.children=[]),f.children.push(R)}f.children&&((a=f.children)==null?void 0:a.length)>0&&((u=I.children)==null||u.push(f))}if(h.three instanceof z){const f={data:{Name:"Perspective Camera"},children:[{data:{Name:"Near Frustum",Value:h.three.near,World:e.uuid}},{data:{Name:"Far Frustum",Value:h.three.far,World:e.uuid}},{data:{Name:"Field of View",Value:h.three.fov,World:e.uuid}}]};if(h.hasCameraControls()){const{controls:b}=h,y={dollyDragInverted:"Invert Drag",dollySpeed:"Dolly Speed",truckSpeed:"Truck Speed",smoothTime:"Smooth Time"};for(const C in y){const R=b[C];R!=null&&((p=f.children)==null||p.push({data:{Name:y[C],Value:R,World:e.uuid}}))}}(g=I.children)==null||g.push(f)}if(x instanceof A){const{postproduction:f}=x,b=f.n8ao.configuration,y={data:{Name:"Renderer"},children:[{data:{Name:"Gamma Correction",Value:f.settings.gamma??!1,World:e.uuid,IsGammaConfig:!0}},{data:{Name:"Ambient Oclussion",Value:f.settings.ao??!1,World:e.uuid,IsAOConfig:!0},children:[{data:{Name:"Samples",Value:b.aoSamples,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Color",Value:`#${b.color.getHexString()}`,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Half Resolution",Value:b.halfRes,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Screen Space Radius",Value:b.screenSpaceRadius,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Radius",Value:b.aoRadius,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Intensity",Value:b.intensity,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Distance Falloff",Value:b.distanceFalloff,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Samples",Value:b.denoiseSamples,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Radius",Value:b.denoiseRadius,World:e.uuid,IsAOConfig:!0}}]},{data:{Name:"Custom Effects",Value:f.settings.custom??!1,World:e.uuid,IsCEConfig:!0},children:[{data:{Name:"Gloss",Value:f.customEffects.glossEnabled,World:e.uuid,IsGlossConfig:!0},children:[{data:{Name:"Min",Value:f.customEffects.minGloss,World:e.uuid,IsGlossConfig:!0}},{data:{Name:"Max",Value:f.customEffects.maxGloss,World:e.uuid,IsGlossConfig:!0}},{data:{Name:"Exponent",Value:f.customEffects.glossExponent,World:e.uuid,IsGlossConfig:!0}}]},{data:{Name:"Outline",Value:f.customEffects.outlineEnabled,World:e.uuid,IsOutlineConfig:!0},children:[{data:{Name:"Color",get Value(){const C=new H(f.customEffects.lineColor),R=f.customEffects.opacity;return JSON.stringify({color:`#${C.getHexString()}`,opacity:R})},World:e.uuid,IsOutlineConfig:!0}},{data:{Name:"Tolerance",Value:f.customEffects.tolerance,World:e.uuid,IsOutlineConfig:!0}}]}]}]};(m=I.children)==null||m.push(y)}l.push(I)}i.columns=[{name:"Name",width:"11rem"}],i.hiddenColumns=["World","Light","IsAOConfig","IsCEConfig","IsGlossConfig","IsOutlineConfig","IsGammaConfig","IsGridConfig"],i.data=l})} headers-hidden expanded>
     <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
        No worlds to configure
      </bim-label>
    </bim-table>
  `},gt=(t,n=!0)=>{const r=M.create(pt,t);if(n){const[,s]=r,{components:c}=t;c.get(oe).list.onItemDeleted.add(()=>s())}return r},ht=Object.freeze(Object.defineProperty({__proto__:null,worldsConfiguration:gt},Symbol.toStringTag,{value:"Module"})),Ct={...Le,...Ve,..._e,...tt,...rt,...ht,...Ee,...$e,...Re};export{Ct as t};
